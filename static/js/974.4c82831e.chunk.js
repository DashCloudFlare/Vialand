"use strict";(self.webpackChunkvialand=self.webpackChunkvialand||[]).push([[974],{6791:function(e,n,t){t.d(n,{r:function(){return i}});var r=t(4165),u=t(5861),c=t(9439),a=t(7313),s=t(9225);function i(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=(0,a.useState)("idle"),i=(0,c.Z)(t,2),o=i[0],l=i[1],f=(0,a.useState)(null),p=(0,c.Z)(f,2),d=p[0],v=p[1],h=(0,a.useState)(null),x=(0,c.Z)(h,2),m=x[0],Z=x[1],g="pending"===o,b="error"===o,w=(0,a.useCallback)(function(){var n=(0,u.Z)((0,r.Z)().mark((function n(t){var u;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return l("pending"),v(null),Z(null),n.prev=3,n.next=6,e();case 6:return u=n.sent,t&&(v(u),l("success")),n.abrupt("return",u);case 11:n.prev=11,n.t0=n.catch(3),t&&(l("error"),Z(n.t0));case 14:case"end":return n.stop()}}),n,null,[[3,11]])})));return function(e){return n.apply(this,arguments)}}(),[e]);return(0,s.u)((function(e){n&&w(e())}),[n]),(0,a.useEffect)((function(){return function(){l("idle"),v(null),Z(null)}}),[]),{isLoading:g,isError:b,status:o,data:d,error:m,execute:function(){return w(!0)}}}},3737:function(e,n,t){t.d(n,{M:function(){return c}});var r=t(9439),u=t(7313);function c(e){var n=e.ref,t=e.offset,c=void 0===t?50:t,a=e.loading,s=e.canLoadMore,i=e.fetchFn,o=(0,u.useState)(!1),l=(0,r.Z)(o,2),f=l[0],p=l[1];(0,u.useEffect)((function(){if(null!==n&&void 0!==n&&n.current){var e=function(e){var n=e.target,t=n.getBoundingClientRect().height;n.scrollTop+t>=n.scrollHeight-c?p(!0):p(!1)};return null===n||void 0===n||n.current.addEventListener("scroll",e),function(){var t;null===n||void 0===n||null===(t=n.current)||void 0===t||t.removeEventListener("scroll",e)}}if(document){var t=function(e){var n=e.currentTarget,t=n.getElementById("footer"),r=n.scrollingElement,u=r.scrollHeight,a=r.scrollTop,s=r.clientHeight;Math.abs(u-s-a)<t.getBoundingClientRect().height+c?p(!0):p(!1)};return document.addEventListener("scroll",t),function(){document.removeEventListener("scroll",t)}}}),[]),(0,u.useEffect)((function(){f&&!a&&s&&(null===i||void 0===i||i())}),[f])}},9225:function(e,n,t){t.d(n,{u:function(){return u}});var r=t(7313);function u(e,n){var t=(0,r.useRef)(e);t.current=e;var u=(0,r.useRef)(!1);(0,r.useEffect)((function(){return u.current=!0,t.current((function(){return u.current})),function(){u.current=!1}}),n)}},8468:function(e,n,t){t.d(n,{K:function(){return a}});var r=t(7313),u=t(7890),c=t(1172);function a(){var e=(0,u.TH)(),n=e.pathname,t=e.search,a=(0,u.s0)();return[(0,r.useMemo)((function(){return c.parse(t)}),[t]),(0,r.useCallback)((function(e){a(n+"?"+c.stringify(e,{skipEmptyString:!0,skipNull:!0}),{replace:!0})}),[n,a])]}},3974:function(e,n,t){t.r(n),t.d(n,{default:function(){return y}});var r=t(9439),u=t(3061),c=t(7313),a=t(4511),s=t(7864),i=t(8512),o=t(9542),l=t(8468),f=t(3433),p=t(4165),d=t(1413),v=t(5861),h=t(4925),x=t(573),m=t(6791),Z=t(3737),g=t(5565),b=["execute"];var w=t(6417),k=(0,c.memo)((function(e){var n=e.user,t=e.data,r=void 0===t?[]:t,u=e.pushNews;return(0,w.jsx)(w.Fragment,{children:r.map((function(e){return(0,w.jsx)(o.eu,{data:e,user:n,onPushNews:u},e.id)}))})}));function y(e){var n=e.readOnly,t=void 0!==n&&n,y=e.user,N=(0,a.$)().t,E=(0,c.useRef)(null),j=(0,c.useRef)(null),L=(0,l.K)(),C=(0,r.Z)(L,2),S=C[0],R=C[1],M=function(e,n,t){var u=(0,a.$)().t,s=(0,c.useState)(!1),o=(0,r.Z)(s,2),l=o[0],w=o[1],k=(0,c.useState)([]),y=(0,r.Z)(k,2),N=y[0],E=y[1],j=(0,c.useState)(void 0),L=(0,r.Z)(j,2),C=L[0],S=L[1],R=(0,m.r)((function(){return H.apply(this,arguments)}),!1),M=R.execute,T=(0,h.Z)(R,b);function B(){return(B=(0,v.Z)((0,p.Z)().mark((function e(){var n;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M();case 3:(n=e.sent)&&E((function(e){return[].concat((0,f.Z)(e),(0,f.Z)(n))})),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function H(){return(H=(0,v.Z)((0,p.Z)().mark((function e(){var r,u,c,a,s;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=[],n&&r.push((0,x.ar)("contactNumber","==",n)),C&&r.push((0,x.TQ)(C)),t||r.push((0,x.ar)("published","==",!0),(0,x.b9)(10)),u=x.IO.apply(void 0,[(0,x.hJ)(g.db,"properties"),(0,x.Xo)("createdAt","desc")].concat(r)),c=[],e.next=9,(0,x.PL)(u);case 9:return a=e.sent,s=a.docs[a.docs.length-1],a.forEach((function(e){c.push((0,d.Z)({id:e.id},e.data()))})),S(s),w(!1),e.abrupt("return",c);case 17:e.prev=17,e.t0=e.catch(0);case 19:case"end":return e.stop()}}),e,null,[[0,17]])})))).apply(this,arguments)}(0,Z.M)({ref:e,canLoadMore:!!C,loading:T.isLoading,fetchFn:function(){return B.apply(this,arguments)}});var _=function(){var e=(0,v.Z)((0,p.Z)().mark((function e(n,r){var c,a,s;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=14;break}if(c=N.slice(),!((a=c.findIndex((function(e){return e.id===n.id})))>-1)){e.next=14;break}return c[a]=(0,d.Z)((0,d.Z)({},c[a]),{},{published:!0}),e.prev=5,s=(0,x.JU)(g.db,"properties",n.id),e.next=9,(0,x.pl)(s,c[a]);case 9:i.Am.success(u("push_news_successfully")),E(c);case 11:return e.prev=11,r(),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[5,,11,14]])})));return function(n,t){return e.apply(this,arguments)}}(),A=(0,c.useCallback)((function(){E([]),S(void 0),w(!0)}),[]);return(0,c.useEffect)((function(){A()}),[n]),(0,c.useEffect)((function(){function e(){return(e=(0,v.Z)((0,p.Z)().mark((function e(){var n;return(0,p.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M();case 2:n=e.sent,E(null!==n&&void 0!==n?n:[]);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}l&&function(){e.apply(this,arguments)}()}),[l]),(0,d.Z)((0,d.Z)({},T),{},{data:N,clear:A,pushNews:_})}(E,S.phoneNumber,y),T=M.data,B=M.isLoading,H=M.pushNews;return(0,w.jsxs)("div",{className:(0,u.Z)("h-full flex items-center flex-col",!t&&"p-2 md:p-5"),children:[!t&&(0,w.jsxs)("div",{className:"flex gap-2 mb-3",children:[(0,w.jsx)("input",{ref:j,defaultValue:S.phoneNumber,placeholder:"0911xxxxxx",className:"input",type:"text",maxLength:12}),(0,w.jsxs)("button",{className:"btn",type:"button",onClick:function(){if(j.current){var e=j.current.value;e&&e.match(/^[0-9]*$/)?R({phoneNumber:e.trim()}):i.Am.warn("".concat(N("invalid_phone_number")))}},children:[(0,w.jsx)(s.RB5,{}),N("search")]})]}),!B&&!(null!==T&&void 0!==T&&T.length)&&(0,w.jsx)(o.x4,{title:"Kh\xf4ng c\xf3 th\xf4ng tin"}),(0,w.jsxs)("div",{className:"max-w-[1000px] w-full flex-1 overflow-y-auto",ref:E,children:[(0,w.jsx)(k,{data:T,user:y,pushNews:H}),B&&(0,w.jsx)(o.x4,{title:(0,w.jsxs)("div",{className:"flex items-center gap-2",children:[(0,w.jsx)(s.Z7b,{className:"animate-spin"})," ",N("searching")]})})]})]})}}}]);