"use strict";(self.webpackChunkvialand=self.webpackChunkvialand||[]).push([[992],{6791:function(e,r,n){n.d(r,{r:function(){return o}});var t=n(4165),a=n(5861),c=n(9439),u=n(7313),i=n(9225);function o(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=(0,u.useState)("idle"),o=(0,c.Z)(n,2),s=o[0],l=o[1],f=(0,u.useState)(null),d=(0,c.Z)(f,2),p=d[0],v=d[1],h=(0,u.useState)(null),g=(0,c.Z)(h,2),m=g[0],Z=g[1],x="pending"===s,y="error"===s,b=(0,u.useCallback)(function(){var r=(0,a.Z)((0,t.Z)().mark((function r(n){var a;return(0,t.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return l("pending"),v(null),Z(null),r.prev=3,r.next=6,e();case 6:return a=r.sent,n&&(v(a),l("success")),r.abrupt("return",a);case 11:r.prev=11,r.t0=r.catch(3),n&&(l("error"),Z(r.t0));case 14:case"end":return r.stop()}}),r,null,[[3,11]])})));return function(e){return r.apply(this,arguments)}}(),[e]);return(0,i.u)((function(e){r&&b(e())}),[r]),(0,u.useEffect)((function(){return function(){l("idle"),v(null),Z(null)}}),[]),{isLoading:x,isError:y,status:s,data:p,error:m,execute:function(){return b(!0)}}}},3737:function(e,r,n){n.d(r,{M:function(){return c}});var t=n(9439),a=n(7313);function c(e){var r=e.ref,n=e.offset,c=void 0===n?50:n,u=e.loading,i=e.canLoadMore,o=e.fetchFn,s=(0,a.useState)(!1),l=(0,t.Z)(s,2),f=l[0],d=l[1];(0,a.useEffect)((function(){if(null!==r&&void 0!==r&&r.current){var e=function(e){var r=e.target,n=r.getBoundingClientRect().height;r.scrollTop+n>=r.scrollHeight-c?d(!0):d(!1)};return null===r||void 0===r||r.current.addEventListener("scroll",e),function(){var n;null===r||void 0===r||null===(n=r.current)||void 0===n||n.removeEventListener("scroll",e)}}if(document){var n=function(e){var r=e.currentTarget,n=r.getElementById("footer"),t=r.scrollingElement,a=t.scrollHeight,u=t.scrollTop,i=t.clientHeight;Math.abs(a-i-u)<n.getBoundingClientRect().height+c?d(!0):d(!1)};return document.addEventListener("scroll",n),function(){document.removeEventListener("scroll",n)}}}),[]),(0,a.useEffect)((function(){f&&!u&&i&&(null===o||void 0===o||o())}),[f])}},9225:function(e,r,n){n.d(r,{u:function(){return a}});var t=n(7313);function a(e,r){var n=(0,t.useRef)(e);n.current=e;var a=(0,t.useRef)(!1);(0,t.useEffect)((function(){return a.current=!0,n.current((function(){return a.current})),function(){a.current=!1}}),r)}},8468:function(e,r,n){n.d(r,{K:function(){return u}});var t=n(7313),a=n(7890),c=n(1172);function u(){var e=(0,a.TH)(),r=e.pathname,n=e.search,u=(0,a.s0)();return[(0,t.useMemo)((function(){return c.parse(n)}),[n]),(0,t.useCallback)((function(e){u(r+"?"+c.stringify(e,{skipEmptyString:!0,skipNull:!0}),{replace:!0})}),[r,u])]}},6243:function(e,r,n){n.d(r,{db:function(){return x}});var t=n(271),a=n(995),c=n(573),u=n(6797),i=n(8941),o=i.Z.firebase,s=o.apiKey,l=o.appId,f=o.databaseURL,d=o.projectId,p=o.storageBucket,v=o.authDomain,h=o.messagingSenderId,g=i.Z.google.recaptchaSiteKey,m={apiKey:s,authDomain:v,databaseURL:f,projectId:d,storageBucket:p,messagingSenderId:h,appId:l},Z=(0,t.ZF)(m),x=(0,c.ad)(Z);(0,u.cF)(Z),(0,a.yu)(Z,{provider:new a.z9(g),isTokenAutoRefreshEnabled:!0})},7992:function(e,r,n){n.r(r),n.d(r,{default:function(){return L}});var t=n(1413),a=n(9439),c=n(7313),u=n(4511),i=n(7864),o=n(7890),s=n(753),l=n(9968),f=n(887),d=n(8468),p=n(3433),v=n(4165),h=n(5861),g=n(4925),m=n(573),Z=n(6791),x=n(3737),y=n(6243),b=n(8469),w=["execute"],E=function(e,r){if(!e)return[];var n=r===f.Hx.trade?1e3:1;switch(e){case"under_1":return[(0,m.ar)("price","<=",1*n)];case"1_2":return[(0,m.ar)("price",">=",1*n),(0,m.ar)("price","<=",2*n)];case"2_3":return[(0,m.ar)("price",">=",2*n),(0,m.ar)("price","<=",3*n)];case"3_5":return[(0,m.ar)("price",">=",3*n),(0,m.ar)("price","<=",5*n)];case"5_8":return[(0,m.ar)("price",">=",5*n),(0,m.ar)("price","<=",8*n)];case"8_15":return[(0,m.ar)("price",">=",8*n),(0,m.ar)("price","<=",15*n)];case"15_30":return[(0,m.ar)("price",">=",15*n),(0,m.ar)("price","<=",30*n)];case"upper_30":return[(0,m.ar)("price",">=",30*n)]}};var k=n(6417),T=(0,c.memo)((function(e){var r=e.data,n=void 0===r?[]:r;return(0,k.jsx)(k.Fragment,{children:n.map((function(e){return(0,k.jsx)(s.eu,{data:e},e.id)}))})}));function L(){var e=(0,u.$)().t,r=(0,o.TH)().pathname,n=(0,d.K)(),L=(0,a.Z)(n,2),R=L[0],j=L[1],H=(0,c.useRef)(null),S=function(e,r){var n=(0,c.useRef)(void 0),u=(0,o.TH)().pathname,i=u.startsWith("/mua-ban")?f.Hx.trade:f.Hx.rent,s=(0,b.Yg)((0,t.Z)((0,t.Z)({},r),{},{action:i})),d=(0,l.M)(),k=d.set,T=d.get,L=(0,c.useState)(!1),R=(0,a.Z)(L,2),j=R[0],H=R[1],S=(0,c.useState)([]),C=(0,a.Z)(S,2),K=C[0],M=C[1],I=(0,c.useState)(void 0),_=(0,a.Z)(I,2),F=_[0],P=_[1],B=(0,Z.r)((function(){return D.apply(this,arguments)}),!1),N=B.execute,W=(0,g.Z)(B,w);function A(){return(A=(0,h.Z)((0,v.Z)().mark((function e(){var r;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N();case 3:(r=e.sent)&&M((function(e){return[].concat((0,p.Z)(e),(0,p.Z)(r))})),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function D(){return(D=(0,h.Z)((0,v.Z)().mark((function e(){var t,a,c,u,o;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=[],r.ward&&t.push((0,m.ar)("ward","==",+r.ward)),r.district&&t.push((0,m.ar)("district","==",+r.district)),r.province&&t.push((0,m.ar)("province","==",+r.province)),r.houseType&&t.push((0,m.ar)("houseType","==",+r.houseType)),F&&t.push((0,m.TQ)(F)),r.priceRange?t.unshift((0,m.Xo)("price","desc")):t.unshift((0,m.Xo)("createdAt","desc")),a=m.IO.apply(void 0,[(0,m.hJ)(y.db,"properties")].concat(t,[(0,m.ar)("published","==",!0),(0,m.ar)("action","==",i)],(0,p.Z)(E(r.priceRange,i)),[(0,m.b9)(10)])),c=[],e.next=12,(0,m.PL)(a);case 12:return u=e.sent,o=u.docs[u.docs.length-1],u.forEach((function(e){c.push(e.data())})),P(o),n.current={data:[].concat((0,p.Z)(K),c),cursor:o,hashKey:s},H(!1),e.abrupt("return",c);case 21:e.prev=21,e.t0=e.catch(0);case 23:case"end":return e.stop()}}),e,null,[[0,21]])})))).apply(this,arguments)}(0,x.M)({ref:e,canLoadMore:!!F,loading:W.isLoading,fetchFn:function(){return A.apply(this,arguments)}});var U=(0,c.useCallback)((function(){M([]),P(void 0),H(!0)}),[]);return(0,c.useEffect)((function(){U()}),[r.priceRange,r.district,r.province,r.ward,r.houseType]),(0,c.useEffect)((function(){var r=0,a=e.current;function c(e){r=e.target.scrollTop}return null===a||void 0===a||a.addEventListener("scroll",c),function(){n.current&&k(u,(0,t.Z)((0,t.Z)({},n.current),{},{scrollPos:r})),null===a||void 0===a||a.removeEventListener("scroll",c)}}),[u]),(0,c.useEffect)((function(){function e(){return(e=(0,h.Z)((0,v.Z)().mark((function e(){var r;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N();case 2:r=e.sent,M(null!==r&&void 0!==r?r:[]);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var r=T(u);if(r&&r.hashKey===s){var t=r.data,a=r.cursor;return n.current={data:t,cursor:a,hashKey:s},M(t),P(a),void H(!1)}j&&function(){e.apply(this,arguments)}()}),[j]),(0,c.useEffect)((function(){return function(){U()}}),[u]),(0,c.useEffect)((function(){var r=T(u);e.current&&K&&void 0!=(null===r||void 0===r?void 0:r.scrollPos)&&e.current.scroll({top:r.scrollPos,left:0});var n=setTimeout((function(){r&&void 0!=r.scrollPos&&k(u,(0,t.Z)((0,t.Z)({},r),{},{scrollPos:void 0}))}),0);return function(){clearTimeout(n)}}),[K]),(0,t.Z)((0,t.Z)({},W),{},{data:K,clear:U})}(H,R),C=S.isLoading,K=S.data,M=S.clear,I=(0,l.M)().clear;(0,c.useEffect)((function(){document.title=r.startsWith("/mua-ban")?"Mua b\xe1n":"Cho thu\xea"}),[r]);var _=r.startsWith("/mua-ban")?f.Hx.trade:f.Hx.rent,F=R.province,P=R.district,B=R.ward,N=R.priceRange,W=R.houseType;return(0,k.jsxs)("div",{className:"p-2 md:p-5 h-full flex items-center flex-col",children:[(0,k.jsx)(s.wn,{action:_,value:{province:F,district:P,ward:B,priceRange:N,houseType:W},onFilter:function(e){j((0,t.Z)((0,t.Z)({},R),e))},onClear:function(){j({}),M(),I(r)}}),!C&&!(null!==K&&void 0!==K&&K.length)&&(0,k.jsx)(s.x4,{title:"Kh\xf4ng c\xf3 th\xf4ng tin"}),(0,k.jsxs)("div",{className:"max-w-[1000px] w-full flex-1 overflow-y-auto",ref:H,children:[(0,k.jsx)(T,{data:K}),C&&(0,k.jsx)(s.x4,{title:(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(i.Z7b,{className:"animate-spin"})," ",e("searching")]})})]})]})}}}]);