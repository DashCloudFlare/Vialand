"use strict";(self.webpackChunkvialand=self.webpackChunkvialand||[]).push([[131],{5905:function(n,e,t){t.d(e,{iy:function(){return i},$m:function(){return c}});var r=t(9869),a=t(8941).Z.common.baseApiUrl,c=function(){return(0,r.Z)("GET",a+"/renew")},i=function(){return(0,r.Z)("POST",a+"/notification")}},6791:function(n,e,t){t.d(e,{r:function(){return u}});var r=t(4165),a=t(5861),c=t(9439),i=t(7313),s=t(9225);function u(n){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=(0,i.useState)("idle"),u=(0,c.Z)(t,2),o=u[0],l=u[1],d=(0,i.useState)(null),h=(0,c.Z)(d,2),f=h[0],p=h[1],x=(0,i.useState)(null),m=(0,c.Z)(x,2),v=m[0],g=m[1],b="pending"===o,j="error"===o,w=(0,i.useCallback)(function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l("pending"),p(null),g(null),e.prev=3,e.next=6,n();case 6:return a=e.sent,t&&(p(a),l("success")),e.abrupt("return",a);case 11:e.prev=11,e.t0=e.catch(3),t&&(l("error"),g(e.t0));case 14:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(n){return e.apply(this,arguments)}}(),[n]);return(0,s.u)((function(n){e&&w(n())}),[e]),(0,i.useEffect)((function(){return function(){l("idle"),p(null),g(null)}}),[]),{isLoading:b,isError:j,status:o,data:f,error:v,execute:function(){return w(!0)}}}},9225:function(n,e,t){t.d(e,{u:function(){return a}});var r=t(7313);function a(n,e){var t=(0,r.useRef)(n);t.current=n;var a=(0,r.useRef)(!1);(0,r.useEffect)((function(){return a.current=!0,t.current((function(){return a.current})),function(){a.current=!1}}),e)}},8468:function(n,e,t){t.d(e,{K:function(){return i}});var r=t(7313),a=t(7890),c=t(1172);function i(){var n=(0,a.TH)(),e=n.pathname,t=n.search,i=(0,a.s0)();return[(0,r.useMemo)((function(){return c.parse(t)}),[t]),(0,r.useCallback)((function(n){i(e+"?"+c.stringify(n,{skipEmptyString:!0,skipNull:!0}),{replace:!0})}),[e,i])]}},3278:function(n,e,t){t.d(e,{Fp:function(){return a},Qm:function(){return r},yC:function(){return c}});var r=function(n,e){return Promise.all(n.map((function(n){return fetch("https://www.googleapis.com/drive/v2/files/".concat(n.id,"?fields=thumbnailLink,embedLink,id"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}})}))).then((function(n){return Promise.all(n.map((function(n){return n.json()}))).then((function(n){return n.map((function(n){return{id:n.id,thumbnailLink:n.thumbnailLink,embedLink:n.embedLink,webViewLink:n.webViewLink}}))}))})).catch()},a=function(n,e){return fetch("https://www.googleapis.com/drive/v3/files/".concat(n),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}}).then((function(){return!0})).catch((function(){return!1}))},c=function(n,e){var t=[];return["video","images","paymentImage"].forEach((function(r){var c=n[r];c&&(Array.isArray(c)?c.forEach((function(n){return t.push(a(n.id,e))})):Object.keys(c).length&&null!==c&&void 0!==c&&c.id&&t.push(a(null===c||void 0===c?void 0:c.id,e)))})),t}},4131:function(n,e,t){t.r(e),t.d(e,{default:function(){return E}});var r=t(4165),a=t(3433),c=t(5861),i=t(9439),s=t(3061),u=t(658),o=t.n(u),l=t(4457),d=t(7313),h=t(7864),f=t(2539),p=t(8512),x=t(5905),m=t(623),v=t(7629),g=t(5857),b=t(8468),j=t(5123),w=t(3278),k=t(1413),Z=t(4925),N=t(6791),y=t(9225),T=["execute"];var C=t(6417);function E(){var n=(0,g.Eu)().token,e=(0,b.K)(),t=(0,i.Z)(e,2),u=t[0],E=t[1],L=function(n){var e=n.slug,t=(0,d.useState)(void 0),a=(0,i.Z)(t,2),s=a[0],u=a[1],o=(0,d.useState)(!1),h=(0,i.Z)(o,2),f=h[0],p=h[1],x=(0,N.r)((function(){return g.apply(this,arguments)}),!1),m=x.execute,v=(0,Z.Z)(x,T);function g(){return(g=(0,c.Z)((0,r.Z)().mark((function n(){var t,a,c,i;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=[],n.prev=1,e&&t.push((0,l.ar)("slug","==",e)),s&&!e&&t.push((0,l.TQ)(s)),a=l.IO.apply(void 0,[(0,l.hJ)(j.db,"properties"),(0,l.Xo)("createdAt","desc")].concat(t,[(0,l.b9)(20)])),c=[],n.next=8,(0,l.PL)(a);case 8:return i=n.sent,u(i.docs[i.docs.length-1]),i.forEach((function(n){c.push((0,k.Z)({id:n.id},n.data()))})),n.abrupt("return",c);case 14:return n.prev=14,n.t0=n.catch(1),n.abrupt("return",[]);case 17:case"end":return n.stop()}}),n,null,[[1,14]])})))).apply(this,arguments)}var b=(0,d.useCallback)((function(){p(!1)}),[]),w=(0,d.useCallback)((function(){u(void 0),p(!1)}),[]);return(0,y.u)((function(n){!f&&n()&&(m(),p(!0))}),[f]),(0,k.Z)((0,k.Z)({},v),{},{refetch:b,clear:w})}({slug:u.slug}),P=L.isLoading,A=L.data,D=L.refetch,S=L.clear,I=(0,d.useState)([]),V=(0,i.Z)(I,2),G=V[0],H=V[1];(0,d.useEffect)((function(){H(null!==A&&void 0!==A?A:[])}),[A]);var B=(0,d.useRef)(null),J=(0,d.useCallback)(function(){var n=(0,c.Z)((0,r.Z)().mark((function n(e,t){var c,i,s;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c=(0,a.Z)(G),!((i=c.findIndex((function(n){return n.id===e})))>-1)){n.next=18;break}return c[i][t]=!c[i][t],H(c),n.prev=6,s=(0,l.JU)(j.db,"properties",e),n.next=10,(0,l.pl)(s,c[i]);case 10:p.Am.success("Thao t\xe1c th\xe0nh c\xf4ng"),n.next=18;break;case 13:n.prev=13,n.t0=n.catch(6),c[i][t]=!c[i][t],H(c);case 18:case"end":return n.stop()}}),n,null,[[6,13]])})));return function(e,t){return n.apply(this,arguments)}}(),[G]),O=(0,d.useCallback)(function(){var e=(0,c.Z)((0,r.Z)().mark((function e(t){var c,i,s,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=(0,a.Z)(G),!((i=c.findIndex((function(n){return n.id===t})))>-1)){e.next=9;break}return s=(0,l.JU)(j.db,"properties",t),u=Promise.all([(0,l.oe)(s)].concat((0,w.yC)(c[i],n))),e.next=7,p.Am.promise(u,{pending:"\u0110ang x\xf3a b\xe0i \u0111\u0103ng",success:"X\xf3a b\xe0i \u0111\u0103ng th\xe0nh c\xf4ng",error:v.v});case 7:c.splice(i,1),H(c);case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[G,n]),R=(0,d.useCallback)(function(){var e=(0,c.Z)((0,r.Z)().mark((function e(t,c){var i,s,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(0,a.Z)(G),!((s=i.findIndex((function(n){return n.id===t})))>-1)){e.next=13;break}return e.prev=3,i[s].video=null,u=(0,l.JU)(j.db,"properties",t),e.next=8,p.Am.promise(Promise.all([(0,l.pl)(u,i[s]),(0,w.Fp)(c,n)]),{pending:"\u0110ang x\xf3a video",success:"X\xf3a video th\xe0nh c\xf4ng",error:v.v});case 8:H(i),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(3);case 13:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(n,t){return e.apply(this,arguments)}}(),[n,G]),U=function(){var n=(0,c.Z)((0,r.Z)().mark((function n(){var e,t;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,x.$m)();case 3:e=n.sent,t=e.data,200===e.status&&window.open(t,"_blank","resizable=yes,top=200,left=200,width=480,height=640"),n.next=11;break;case 9:n.prev=9,n.t0=n.catch(0);case 11:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(){return n.apply(this,arguments)}}();return(0,d.useEffect)((function(){u.slug&&(B.current.value=u.slug)}),[u.slug]),(0,C.jsxs)("div",{className:"min-h-screen p-5",children:[(0,C.jsx)("h1",{className:"font-medium text-base md:text-lg mb-5",children:"Danh s\xe1ch tin"}),(0,C.jsxs)("div",{className:"w-full",children:[(0,C.jsxs)("div",{className:"flex my-2 gap-2 flex-wrap",children:[(0,C.jsx)("input",{ref:B,placeholder:"Nh\u1eadp ID c\u1ea7n tra c\u1ee9u",type:"text",className:"input max-w-[400px] w-full"}),(0,C.jsxs)("button",{onClick:function(n){B.current.value&&(E({slug:B.current.value}),D())},className:"btn",children:[(0,C.jsx)(h.RB5,{}),(0,C.jsx)("span",{children:"Tra c\u1ee9u"})]}),(0,C.jsxs)("button",{onClick:function(){B.current&&(u.slug&&S(),B.current.value="",E({}))},className:"btn btn--secondary",children:[(0,C.jsx)(h.oHP,{}),(0,C.jsx)("span",{children:"X\xf3a"})]}),(0,C.jsx)("div",{className:"flex-grow"}),(0,C.jsxs)("button",{onClick:function(){S()},className:"btn",children:[(0,C.jsx)(h.Em2,{}),(0,C.jsx)("span",{children:"Refresh"})]}),(0,C.jsxs)("button",{onClick:U,className:"btn",children:[(0,C.jsx)(h.IDO,{}),(0,C.jsx)("span",{children:"L\xe0m m\u1edbi token"})]})]}),(0,C.jsx)("div",{className:"overflow-auto",children:(0,C.jsxs)("table",{className:"table-auto",children:[(0,C.jsx)("thead",{children:(0,C.jsxs)("tr",{children:[(0,C.jsx)("th",{className:"min-w-[200px] max-w-[300px]",children:"T\xean"}),(0,C.jsx)("th",{className:"min-w-[130px] max-w-[300px]",children:"Ng\xe0y \u0111\u0103ng"}),(0,C.jsx)("th",{children:"\u1ea2nh thanh to\xe1n"}),(0,C.jsx)("th",{children:"Link video"}),(0,C.jsx)("th",{className:"min-w-[130px] max-w-[300px]",children:"Thao t\xe1c video"}),(0,C.jsx)("th",{className:"min-w-[130px] max-w-[300px]",children:"Thao t\xe1c b\xe0i \u0111\u0103ng"}),(0,C.jsx)("th",{className:"min-w-[130px] max-w-[300px]",children:"Ghim trang ch\u1ee7"}),(0,C.jsx)("th",{className:"min-w-[130px] max-w-[300px]",children:"Ghim d\u1ef1 \xe1n"})]})}),(0,C.jsx)("tbody",{children:null!==G&&void 0!==G&&G.length?(0,C.jsx)(C.Fragment,{children:null===G||void 0===G?void 0:G.map((function(n){var e=n.id,t=n.subject,r=n.video,a=n.createdAt,c=n.hideVideo,i=n.published,s=n.paymentImage,u=n.featurePinned,l=n.projectPinned;return(0,C.jsxs)("tr",{className:"hover:bg-gray-100 cursor-default",children:[(0,C.jsx)("td",{children:(0,C.jsx)("p",{className:"mx-auto text-sm",children:t})}),(0,C.jsx)("td",{children:(0,C.jsx)("p",{className:"mx-auto text-sm",children:o()(1e3*a).format("DD/MM/YYYY - HH:mm")})}),(0,C.jsx)("td",{children:s?(0,C.jsx)("img",{className:"relative w-[150px] h-[150px] object-cover",src:"https://lh3.googleusercontent.com/d/".concat(s.id),alt:""}):"---"}),(0,C.jsx)("td",{children:r?(0,C.jsx)("object",{className:"relative mx-auto w-[192px] aspect-video",data:r.value,title:"video"}):"---"}),(0,C.jsx)("td",{children:(0,C.jsx)(m.o1,{toggleText:c?"Hi\u1ec7n":"\u1ea8n",hideToggle:!r,disableDelete:!r,booleanVal:c,onDelete:function(){return R(e,r.id)},onToggle:function(){return J(e,"hideVideo")}})}),(0,C.jsx)("td",{children:(0,C.jsx)(m.o1,{toggleText:i?"\u1ea8n":"Hi\u1ec7n",booleanVal:!i,onDelete:function(){return O(e)},onToggle:function(){return J(e,"published")}})}),(0,C.jsx)("td",{children:(0,C.jsx)(m.o1,{toggleText:u?"B\u1ecf ghim":"Ghim",booleanVal:!u,onToggle:function(){return J(e,"featurePinned")}})}),(0,C.jsx)("td",{children:(0,C.jsx)(m.o1,{toggleText:l?"B\u1ecf ghim":"Ghim",booleanVal:!l,onToggle:function(){return J(e,"projectPinned")}})})]},e)}))}):(0,C.jsx)("tr",{className:"text-center",children:(0,C.jsx)("td",{colSpan:100,children:P?"Loading...":"Kh\xf4ng c\xf3 data"})})})]})}),(0,C.jsxs)("div",{className:"flex gap-3 mt-5",children:[(0,C.jsxs)("button",{className:"btn",onClick:S,children:[(0,C.jsx)(f.b2E,{}),"Trang \u0111\u1ea7u"]}),(0,C.jsxs)("button",{className:(0,s.Z)("btn",!(null!==A&&void 0!==A&&A.length)||A.length<20&&"btn--disabled"),onClick:D,children:["Trang sau",(0,C.jsx)(f.sOJ,{})]})]})]})]})}}}]);