"use strict";(self.webpackChunkvialand=self.webpackChunkvialand||[]).push([[992],{6791:function(e,r,n){n.d(r,{r:function(){return s}});var t=n(4165),u=n(5861),c=n(9439),a=n(7313),i=n(9225);function s(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=(0,a.useState)("idle"),s=(0,c.Z)(n,2),o=s[0],l=s[1],f=(0,a.useState)(null),p=(0,c.Z)(f,2),d=p[0],v=p[1],h=(0,a.useState)(null),Z=(0,c.Z)(h,2),x=Z[0],g=Z[1],m="pending"===o,w="error"===o,y=(0,a.useCallback)(function(){var r=(0,u.Z)((0,t.Z)().mark((function r(n){var u;return(0,t.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return l("pending"),v(null),g(null),r.prev=3,r.next=6,e();case 6:return u=r.sent,n&&(v(u),l("success")),r.abrupt("return",u);case 11:r.prev=11,r.t0=r.catch(3),n&&(l("error"),g(r.t0));case 14:case"end":return r.stop()}}),r,null,[[3,11]])})));return function(e){return r.apply(this,arguments)}}(),[e]);return(0,i.u)((function(e){r&&y(e())}),[r]),(0,a.useEffect)((function(){return function(){l("idle"),v(null),g(null)}}),[]),{isLoading:m,isError:w,status:o,data:d,error:x,execute:function(){return y(!0)}}}},3737:function(e,r,n){n.d(r,{M:function(){return c}});var t=n(9439),u=n(7313);function c(e){var r=e.ref,n=e.offset,c=void 0===n?50:n,a=e.loading,i=e.canLoadMore,s=e.fetchFn,o=(0,u.useState)(!1),l=(0,t.Z)(o,2),f=l[0],p=l[1];(0,u.useEffect)((function(){if(null!==r&&void 0!==r&&r.current){var e=function(e){var r=e.target,n=r.getBoundingClientRect().height;r.scrollTop+n>=r.scrollHeight-c?p(!0):p(!1)};return null===r||void 0===r||r.current.addEventListener("scroll",e),function(){var n;null===r||void 0===r||null===(n=r.current)||void 0===n||n.removeEventListener("scroll",e)}}}),[]),(0,u.useEffect)((function(){f&&!a&&i&&(null===s||void 0===s||s())}),[f])}},9225:function(e,r,n){n.d(r,{u:function(){return u}});var t=n(7313);function u(e,r){var n=(0,t.useRef)(e);n.current=e;var u=(0,t.useRef)(!1);(0,t.useEffect)((function(){return u.current=!0,n.current((function(){return u.current})),function(){u.current=!1}}),r)}},8468:function(e,r,n){n.d(r,{K:function(){return a}});var t=n(7313),u=n(7890),c=n(1172);function a(){var e=(0,u.TH)(),r=e.pathname,n=e.search,a=(0,u.s0)();return[(0,t.useMemo)((function(){return c.parse(n)}),[n]),(0,t.useCallback)((function(e){a(r+"?"+c.stringify(e,{skipEmptyString:!0,skipNull:!0}),{replace:!0})}),[r,a])]}},7992:function(e,r,n){n.r(r),n.d(r,{default:function(){return j}});var t=n(1413),u=n(9439),c=n(7313),a=n(4511),i=n(7864),s=n(7890),o=n(623),l=n(9968),f=n(887),p=n(8468),d=n(3433),v=n(4165),h=n(5861),Z=n(4925),x=n(4457),g=n(6791),m=n(3737),w=n(5123),y=n(8469),E=["execute"],b=function(e,r){if(!e)return[];var n=r===f.Hx.trade?1e3:1;switch(e){case"under_1":return[(0,x.ar)("price","<=",1*n)];case"1_2":return[(0,x.ar)("price",">=",1*n),(0,x.ar)("price","<=",2*n)];case"2_3":return[(0,x.ar)("price",">=",2*n),(0,x.ar)("price","<=",3*n)];case"3_5":return[(0,x.ar)("price",">=",3*n),(0,x.ar)("price","<=",5*n)];case"5_8":return[(0,x.ar)("price",">=",5*n),(0,x.ar)("price","<=",8*n)];case"8_15":return[(0,x.ar)("price",">=",8*n),(0,x.ar)("price","<=",15*n)];case"15_30":return[(0,x.ar)("price",">=",15*n),(0,x.ar)("price","<=",30*n)];case"upper_30":return[(0,x.ar)("price",">=",30*n)]}};var k=n(6417),T=(0,c.memo)((function(e){var r=e.data,n=void 0===r?[]:r;return(0,k.jsx)(k.Fragment,{children:n.map((function(e){return(0,k.jsx)(o.eu,{data:e},e.id)}))})}));function j(){var e=(0,a.$)().t,r=(0,s.TH)().pathname,n=(0,p.K)(),j=(0,u.Z)(n,2),L=j[0],R=j[1],H=(0,c.useRef)(null),C=function(e,r){var n=(0,c.useRef)(void 0),a=(0,s.TH)().pathname,i=a.startsWith("/mua-ban")?f.Hx.trade:f.Hx.rent,o=(0,y.Yg)((0,t.Z)((0,t.Z)({},r),{},{action:i})),p=(0,l.M)(),k=p.set,T=p.get,j=(0,c.useState)(!1),L=(0,u.Z)(j,2),R=L[0],H=L[1],C=(0,c.useState)([]),M=(0,u.Z)(C,2),S=M[0],_=M[1],K=(0,c.useState)(void 0),P=(0,u.Z)(K,2),N=P[0],F=P[1],W=(0,g.r)((function(){return I.apply(this,arguments)}),!1),X=W.execute,A=(0,Z.Z)(W,E);function B(){return(B=(0,h.Z)((0,v.Z)().mark((function e(){var r;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,X();case 3:(r=e.sent)&&_((function(e){return[].concat((0,d.Z)(e),(0,d.Z)(r))})),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function I(){return(I=(0,h.Z)((0,v.Z)().mark((function e(){var t,u,c,a,s;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=[],r.ward&&t.push((0,x.ar)("ward","==",+r.ward)),r.district&&t.push((0,x.ar)("district","==",+r.district)),r.province&&t.push((0,x.ar)("province","==",+r.province)),r.houseType&&t.push((0,x.ar)("houseType","==",+r.houseType)),N&&t.push((0,x.TQ)(N)),r.priceRange?t.unshift((0,x.Xo)("price","desc")):t.unshift((0,x.Xo)("createdAt","desc")),u=x.IO.apply(void 0,[(0,x.hJ)(w.db,"properties")].concat(t,[(0,x.ar)("published","==",!0),(0,x.ar)("action","==",i)],(0,d.Z)(b(r.priceRange,i)),[(0,x.b9)(10)])),c=[],e.next=12,(0,x.PL)(u);case 12:return a=e.sent,s=a.docs[a.docs.length-1],a.forEach((function(e){c.push(e.data())})),F(s),n.current={data:[].concat((0,d.Z)(S),c),cursor:s,hashKey:o},H(!1),e.abrupt("return",c);case 21:e.prev=21,e.t0=e.catch(0);case 23:case"end":return e.stop()}}),e,null,[[0,21]])})))).apply(this,arguments)}(0,m.M)({ref:e,canLoadMore:!!N,loading:A.isLoading,fetchFn:function(){return B.apply(this,arguments)}});var J=(0,c.useCallback)((function(){_([]),F(void 0),H(!0)}),[]);return(0,c.useEffect)((function(){J()}),[r.priceRange,r.district,r.province,r.ward,r.houseType]),(0,c.useEffect)((function(){var r=0,u=e.current;function c(e){r=e.target.scrollTop}return null===u||void 0===u||u.addEventListener("scroll",c),function(){n.current&&k(a,(0,t.Z)((0,t.Z)({},n.current),{},{scrollPos:r})),null===u||void 0===u||u.removeEventListener("scroll",c)}}),[a]),(0,c.useEffect)((function(){function e(){return(e=(0,h.Z)((0,v.Z)().mark((function e(){var r;return(0,v.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X();case 2:r=e.sent,_(null!==r&&void 0!==r?r:[]);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var r=T(a);if(r&&r.hashKey===o){var t=r.data,u=r.cursor;return n.current={data:t,cursor:u,hashKey:o},_(t),F(u),void H(!1)}R&&function(){e.apply(this,arguments)}()}),[R]),(0,c.useEffect)((function(){return function(){J()}}),[a]),(0,c.useEffect)((function(){var r=T(a);e.current&&S&&void 0!=(null===r||void 0===r?void 0:r.scrollPos)&&e.current.scroll({top:r.scrollPos,left:0});var n=setTimeout((function(){r&&void 0!=r.scrollPos&&k(a,(0,t.Z)((0,t.Z)({},r),{},{scrollPos:void 0}))}),0);return function(){clearTimeout(n)}}),[S]),(0,t.Z)((0,t.Z)({},A),{},{data:S,clear:J})}(H,L),M=C.isLoading,S=C.data,_=C.clear,K=(0,l.M)().clear;(0,c.useEffect)((function(){document.title=r.startsWith("/mua-ban")?"Mua b\xe1n":"Cho thu\xea"}),[r]);var P=r.startsWith("/mua-ban")?f.Hx.trade:f.Hx.rent,N=L.province,F=L.district,W=L.ward,X=L.priceRange,A=L.houseType;return(0,k.jsxs)("div",{className:"p-2 md:p-5 h-full flex items-center flex-col",children:[(0,k.jsx)(o.wn,{action:P,value:{province:N,district:F,ward:W,priceRange:X,houseType:A},onFilter:function(e){R((0,t.Z)((0,t.Z)({},L),e))},onClear:function(){R({}),_(),K(r)}}),!M&&!(null!==S&&void 0!==S&&S.length)&&(0,k.jsx)(o.x4,{title:"Kh\xf4ng c\xf3 th\xf4ng tin"}),(0,k.jsxs)("div",{className:"max-w-[1000px] w-full flex-1 overflow-y-auto",ref:H,children:[(0,k.jsx)(T,{data:S}),M&&(0,k.jsx)(o.x4,{title:(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(i.Z7b,{className:"animate-spin"})," ",e("searching")]})})]})]})}}}]);