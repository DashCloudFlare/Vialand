"use strict";(self.webpackChunkvialand=self.webpackChunkvialand||[]).push([[327],{6791:function(r,e,t){t.d(e,{r:function(){return o}});var n=t(4165),a=t(5861),c=t(9439),i=t(7313),u=t(9225);function o(r){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=(0,i.useState)("idle"),o=(0,c.Z)(t,2),s=o[0],l=o[1],f=(0,i.useState)(null),p=(0,c.Z)(f,2),d=p[0],v=p[1],h=(0,i.useState)(null),g=(0,c.Z)(h,2),Z=g[0],m=g[1],x="pending"===s,b="error"===s,w=(0,i.useCallback)(function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l("pending"),v(null),m(null),e.prev=3,e.next=6,r();case 6:return a=e.sent,t&&(v(a),l("success")),e.abrupt("return",a);case 11:e.prev=11,e.t0=e.catch(3),t&&(l("error"),m(e.t0));case 14:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(r){return e.apply(this,arguments)}}(),[r]);return(0,u.u)((function(r){e&&w(r())}),[e]),(0,i.useEffect)((function(){return function(){l("idle"),v(null),m(null)}}),[]),{isLoading:x,isError:b,status:s,data:d,error:Z,execute:function(){return w(!0)}}}},9225:function(r,e,t){t.d(e,{u:function(){return a}});var n=t(7313);function a(r,e){var t=(0,n.useRef)(r);t.current=r;var a=(0,n.useRef)(!1);(0,n.useEffect)((function(){return a.current=!0,t.current((function(){return a.current})),function(){a.current=!1}}),e)}},8468:function(r,e,t){t.d(e,{K:function(){return i}});var n=t(7313),a=t(7890),c=t(1172);function i(){var r=(0,a.TH)(),e=r.pathname,t=r.search,i=(0,a.s0)();return[(0,n.useMemo)((function(){return c.parse(t)}),[t]),(0,n.useCallback)((function(r){i(e+"?"+c.stringify(r,{skipEmptyString:!0,skipNull:!0}),{replace:!0})}),[e,i])]}},6243:function(r,e,t){t.d(e,{db:function(){return v}});var n=t(271),a=t(4457),c=t(6797),i=t(8941).Z.firebase,u=i.apiKey,o=i.appId,s=i.databaseURL,l=i.projectId,f=i.storageBucket,p={apiKey:u,authDomain:i.authDomain,databaseURL:s,projectId:l,storageBucket:f,messagingSenderId:i.messagingSenderId,appId:o},d=(0,n.ZF)(p),v=(0,a.ad)(d);(0,c.cF)(d)},8469:function(r,e,t){t.d(e,{Yg:function(){return c},tq:function(){return a}});var n=t(9439),a=function(){var r=navigator.userAgent;return!!/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(r)||(!!/Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(r)||!!(navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform)))},c=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.entries(r).sort((function(r,e){var t=(0,n.Z)(r,1)[0],a=(0,n.Z)(e,1)[0];return t.localeCompare(a)})).flat().join("_").toString()}},8327:function(r,e,t){t.r(e),t.d(e,{default:function(){return S}});var n=t(1413),a=t(9439),c=t(7313),i=t(4511),u=t(7864),o=t(7890),s=t(5218),l=t(9968),f=t(887),p=t(8468),d=t(3433),v=t(4165),h=t(5861),g=t(4925),Z=t(4457),m=t(6791);var x=t(6243),b=t(8469),w=["execute"],k=function(r,e){if(!r)return[];var t=e===f.Hx.trade?1e3:1;switch(r){case"under_1":return[(0,Z.ar)("price","<=",1*t)];case"1_2":return[(0,Z.ar)("price",">=",1*t),(0,Z.ar)("price","<=",2*t)];case"2_3":return[(0,Z.ar)("price",">=",2*t),(0,Z.ar)("price","<=",3*t)];case"3_5":return[(0,Z.ar)("price",">=",3*t),(0,Z.ar)("price","<=",5*t)];case"5_8":return[(0,Z.ar)("price",">=",5*t),(0,Z.ar)("price","<=",8*t)];case"8_15":return[(0,Z.ar)("price",">=",8*t),(0,Z.ar)("price","<=",15*t)];case"15_30":return[(0,Z.ar)("price",">=",15*t),(0,Z.ar)("price","<=",30*t)];case"upper_30":return[(0,Z.ar)("price",">=",30*t)]}};function y(r,e){var t=(0,c.useRef)(void 0),i=(0,o.TH)().pathname,u=i.startsWith("/mua-ban")?f.Hx.trade:f.Hx.rent,s=(0,b.Yg)((0,n.Z)((0,n.Z)({},e),{},{action:u})),p=(0,l.M)(),y=p.set,E=p.get,S=(0,c.useState)(!1),j=(0,a.Z)(S,2),I=j[0],L=j[1],R=(0,c.useState)([]),M=(0,a.Z)(R,2),T=M[0],C=M[1],H=(0,c.useState)(void 0),K=(0,a.Z)(H,2),P=K[0],_=K[1],B=(0,m.r)((function(){return O.apply(this,arguments)}),!1),F=B.execute,N=(0,g.Z)(B,w);function A(){return(A=(0,h.Z)((0,v.Z)().mark((function r(){var e;return(0,v.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,F();case 3:(e=r.sent)&&C((function(r){return[].concat((0,d.Z)(r),(0,d.Z)(e))})),r.next=9;break;case 7:r.prev=7,r.t0=r.catch(0);case 9:case"end":return r.stop()}}),r,null,[[0,7]])})))).apply(this,arguments)}function O(){return(O=(0,h.Z)((0,v.Z)().mark((function r(){var n,a,c,i,o;return(0,v.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,n=[],e.ward&&n.push((0,Z.ar)("ward","==",parseInt(e.ward.toString(),10))),e.district&&n.push((0,Z.ar)("district","==",parseInt(e.district.toString(),10))),e.province&&n.push((0,Z.ar)("province","==",parseInt(e.province.toString(),10))),P&&n.push((0,Z.TQ)(P)),e.priceRange?n.unshift((0,Z.Xo)("price","desc")):n.unshift((0,Z.Xo)("createdAt","desc")),a=Z.IO.apply(void 0,[(0,Z.hJ)(x.db,"properties")].concat(n,[(0,Z.ar)("published","==",!0),(0,Z.ar)("action","==",u)],(0,d.Z)(k(e.priceRange,u)),[(0,Z.b9)(10)])),c=[],r.next=11,(0,Z.PL)(a);case 11:return i=r.sent,o=i.docs[i.docs.length-1],i.forEach((function(r){c.push(r.data())})),_(o),t.current={data:[].concat((0,d.Z)(T),c),cursor:o,hashKey:s},L(!1),r.abrupt("return",c);case 20:r.prev=20,r.t0=r.catch(0),console.log(r.t0);case 23:case"end":return r.stop()}}),r,null,[[0,20]])})))).apply(this,arguments)}!function(r){var e=r.ref,t=r.offset,n=void 0===t?50:t,a=r.loading,i=r.canLoadMore,u=r.fetchFn;(0,c.useEffect)((function(){if(e.current){var r=function(r){var e=r.target,t=e.getBoundingClientRect().height;e.scrollTop+t>=e.scrollHeight-n&&i&&!a&&(null===u||void 0===u||u())};return e.current.addEventListener("scroll",r),function(){var t;null===(t=e.current)||void 0===t||t.removeEventListener("scroll",r)}}}))}({ref:r,canLoadMore:!!P,loading:N.isLoading,fetchFn:function(){return A.apply(this,arguments)}});var W=(0,c.useCallback)((function(){C([]),_(void 0),L(!0)}),[]);return(0,c.useEffect)((function(){W()}),[e.priceRange,e.district,e.province,e.ward]),(0,c.useEffect)((function(){var e=0,a=r.current;function c(r){e=r.target.scrollTop}return null===a||void 0===a||a.addEventListener("scroll",c),function(){t.current&&y(i,(0,n.Z)((0,n.Z)({},t.current),{},{scrollPos:e})),null===a||void 0===a||a.removeEventListener("scroll",c)}}),[i]),(0,c.useEffect)((function(){function r(){return(r=(0,h.Z)((0,v.Z)().mark((function r(){var e;return(0,v.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,F();case 2:e=r.sent,C(null!==e&&void 0!==e?e:[]);case 4:case"end":return r.stop()}}),r)})))).apply(this,arguments)}var e=E(i);if(e&&e.hashKey===s){var n=e.data,a=e.cursor;return t.current={data:n,cursor:a,hashKey:s},C(n),_(a),void L(!1)}I&&function(){r.apply(this,arguments)}()}),[I]),(0,c.useEffect)((function(){return function(){W()}}),[i]),(0,c.useEffect)((function(){var e=E(i);r.current&&T&&void 0!=(null===e||void 0===e?void 0:e.scrollPos)&&r.current.scroll({top:e.scrollPos,left:0});var t=setTimeout((function(){e&&void 0!=e.scrollPos&&y(i,(0,n.Z)((0,n.Z)({},e),{},{scrollPos:void 0}))}),0);return function(){clearTimeout(t)}}),[T]),(0,n.Z)((0,n.Z)({},N),{},{data:T,clear:W})}var E=t(6417);function S(){var r=(0,i.$)().t,e=(0,o.TH)().pathname,t=(0,p.K)(),d=(0,a.Z)(t,2),v=d[0],h=d[1],g=(0,c.useRef)(null),Z=y(g,v),m=Z.isLoading,x=Z.data,b=Z.clear,w=(0,l.M)().clear;(0,c.useEffect)((function(){document.title=e.startsWith("/mua-ban")?"Mua b\xe1n":"Cho thu\xea"}),[e]);var k=e.startsWith("/mua-ban")?f.Hx.trade:f.Hx.rent,S=v.province,j=v.district,I=v.ward,L=v.priceRange;return(0,E.jsxs)("div",{className:"p-5 h-full flex items-center flex-col",children:[(0,E.jsx)(s.wn,{action:k,value:{province:S,district:j,ward:I,priceRange:L},onFilter:function(r){h((0,n.Z)((0,n.Z)({},v),r))},onClear:function(){h({}),b(),w(e)}}),!m&&!(null!==x&&void 0!==x&&x.length)&&(0,E.jsx)(s.x4,{title:"Kh\xf4ng c\xf3 th\xf4ng tin"}),(0,E.jsxs)("div",{className:"max-w-[1000px] w-full flex-1 overflow-y-auto",ref:g,children:[null===x||void 0===x?void 0:x.map((function(r){return(0,E.jsx)(s.eu,{data:r},r.id)})),m&&(0,E.jsx)(s.x4,{title:(0,E.jsxs)("div",{className:"flex items-center gap-2",children:[(0,E.jsx)(u.Z7b,{className:"animate-spin"})," ",r("searching")]})})]})]})}}}]);