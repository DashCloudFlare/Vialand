"use strict";(self.webpackChunkvialand=self.webpackChunkvialand||[]).push([[992],{7992:function(e,r,t){t.r(r),t.d(r,{default:function(){return E}});var n=t(1413),a=t(9439),c=t(7313),i=t(4511),s=t(7864),u=t(7890),o=t(2419),p=t(9968),l=t(887),f=t(8468),d=t(3433),h=t(4165),v=t(5861),x=t(4925),Z=t(573),m=t(6791),w=t(3737),g=t(6243),y=t(8469),b=["execute"],T=function(e,r){if(!e)return[];var t=r===l.Hx.trade?1e3:1;switch(e){case"under_1":return[(0,Z.ar)("price","<=",1*t)];case"1_2":return[(0,Z.ar)("price",">=",1*t),(0,Z.ar)("price","<=",2*t)];case"2_3":return[(0,Z.ar)("price",">=",2*t),(0,Z.ar)("price","<=",3*t)];case"3_5":return[(0,Z.ar)("price",">=",3*t),(0,Z.ar)("price","<=",5*t)];case"5_8":return[(0,Z.ar)("price",">=",5*t),(0,Z.ar)("price","<=",8*t)];case"8_15":return[(0,Z.ar)("price",">=",8*t),(0,Z.ar)("price","<=",15*t)];case"15_30":return[(0,Z.ar)("price",">=",15*t),(0,Z.ar)("price","<=",30*t)];case"upper_30":return[(0,Z.ar)("price",">=",30*t)]}};var j=t(6417),k=(0,c.memo)((function(e){var r=e.data,t=void 0===r?[]:r;return(0,j.jsx)(j.Fragment,{children:t.map((function(e){return(0,j.jsx)(o.eu,{data:e},e.id)}))})}));function E(){var e=(0,i.$)().t,r=(0,u.TH)().pathname,t=(0,f.K)(),E=(0,a.Z)(t,2),_=E[0],H=E[1],R=(0,c.useRef)(null),L=function(e,r){var t=(0,c.useRef)(void 0),i=(0,u.TH)().pathname,s=i.startsWith("/mua-ban")?l.Hx.trade:l.Hx.rent,o=(0,y.Yg)((0,n.Z)((0,n.Z)({},r),{},{action:s})),f=(0,p.M)(),j=f.set,k=f.get,E=(0,c.useState)(!1),_=(0,a.Z)(E,2),H=_[0],R=_[1],L=(0,c.useState)([]),P=(0,a.Z)(L,2),C=P[0],K=P[1],M=(0,c.useState)(void 0),N=(0,a.Z)(M,2),F=N[0],S=N[1],W=(0,m.r)((function(){return J.apply(this,arguments)}),!1),X=W.execute,A=(0,x.Z)(W,b);function I(){return(I=(0,v.Z)((0,h.Z)().mark((function e(){var r;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,X();case 3:(r=e.sent)&&K((function(e){return[].concat((0,d.Z)(e),(0,d.Z)(r))})),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function J(){return(J=(0,v.Z)((0,h.Z)().mark((function e(){var n,a,c,i,u;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=[],r.ward&&n.push((0,Z.ar)("ward","==",+r.ward)),r.district&&n.push((0,Z.ar)("district","==",+r.district)),r.province&&n.push((0,Z.ar)("province","==",+r.province)),r.houseType&&n.push((0,Z.ar)("houseType","==",+r.houseType)),F&&n.push((0,Z.TQ)(F)),r.priceRange?n.unshift((0,Z.Xo)("price","desc")):n.unshift((0,Z.Xo)("createdAt","desc")),a=Z.IO.apply(void 0,[(0,Z.hJ)(g.db,"properties")].concat(n,[(0,Z.ar)("published","==",!0),(0,Z.ar)("action","==",s)],(0,d.Z)(T(r.priceRange,s)),[(0,Z.b9)(10)])),c=[],e.next=12,(0,Z.PL)(a);case 12:return i=e.sent,u=i.docs[i.docs.length-1],i.forEach((function(e){c.push(e.data())})),S(u),t.current={data:[].concat((0,d.Z)(C),c),cursor:u,hashKey:o},R(!1),e.abrupt("return",c);case 21:e.prev=21,e.t0=e.catch(0);case 23:case"end":return e.stop()}}),e,null,[[0,21]])})))).apply(this,arguments)}(0,w.M)({ref:e,canLoadMore:!!F,loading:A.isLoading,fetchFn:function(){return I.apply(this,arguments)}});var O=(0,c.useCallback)((function(){K([]),S(void 0),R(!0)}),[]);return(0,c.useEffect)((function(){O()}),[r.priceRange,r.district,r.province,r.ward,r.houseType]),(0,c.useEffect)((function(){var r=0,a=e.current;function c(e){r=e.target.scrollTop}return null===a||void 0===a||a.addEventListener("scroll",c),function(){t.current&&j(i,(0,n.Z)((0,n.Z)({},t.current),{},{scrollPos:r})),null===a||void 0===a||a.removeEventListener("scroll",c)}}),[i]),(0,c.useEffect)((function(){function e(){return(e=(0,v.Z)((0,h.Z)().mark((function e(){var r;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X();case 2:r=e.sent,K(null!==r&&void 0!==r?r:[]);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var r=k(i);if(r&&r.hashKey===o){var n=r.data,a=r.cursor;return t.current={data:n,cursor:a,hashKey:o},K(n),S(a),void R(!1)}H&&function(){e.apply(this,arguments)}()}),[H]),(0,c.useEffect)((function(){return function(){O()}}),[i]),(0,c.useEffect)((function(){var r=k(i);e.current&&C&&void 0!=(null===r||void 0===r?void 0:r.scrollPos)&&e.current.scroll({top:r.scrollPos,left:0});var t=setTimeout((function(){r&&void 0!=r.scrollPos&&j(i,(0,n.Z)((0,n.Z)({},r),{},{scrollPos:void 0}))}),0);return function(){clearTimeout(t)}}),[C]),(0,n.Z)((0,n.Z)({},A),{},{data:C,clear:O})}(R,_),P=L.isLoading,C=L.data,K=L.clear,M=(0,p.M)().clear;(0,c.useEffect)((function(){document.title=r.startsWith("/mua-ban")?"Mua b\xe1n":"Cho thu\xea"}),[r]);var N=r.startsWith("/mua-ban")?l.Hx.trade:l.Hx.rent,F=_.province,S=_.district,W=_.ward,X=_.priceRange,A=_.houseType;return(0,j.jsxs)("div",{className:"p-2 md:p-5 h-full flex items-center flex-col",children:[(0,j.jsx)(o.wn,{action:N,value:{province:F,district:S,ward:W,priceRange:X,houseType:A},onFilter:function(e){H((0,n.Z)((0,n.Z)({},_),e))},onClear:function(){H({}),K(),M(r)}}),!P&&!(null!==C&&void 0!==C&&C.length)&&(0,j.jsx)(o.x4,{title:"Kh\xf4ng c\xf3 th\xf4ng tin"}),(0,j.jsxs)("div",{className:"max-w-[1000px] w-full flex-1 overflow-y-auto",ref:R,children:[(0,j.jsx)(k,{data:C}),P&&(0,j.jsx)(o.x4,{title:(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)(s.Z7b,{className:"animate-spin"})," ",e("searching")]})})]})]})}}}]);