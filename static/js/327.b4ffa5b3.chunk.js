"use strict";(self.webpackChunkvialand=self.webpackChunkvialand||[]).push([[327],{6791:function(e,r,n){n.d(r,{r:function(){return s}});var t=n(4165),a=n(5861),c=n(9439),u=n(7313),i=n(9225);function s(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=(0,u.useState)("idle"),s=(0,c.Z)(n,2),o=s[0],f=s[1],l=(0,u.useState)(null),p=(0,c.Z)(l,2),d=p[0],v=p[1],h=(0,u.useState)(null),g=(0,c.Z)(h,2),x=g[0],m=g[1],Z="pending"===o,b="error"===o,w=function(){var r=(0,a.Z)((0,t.Z)().mark((function r(n){var a;return(0,t.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return f("pending"),v(null),m(null),r.prev=3,r.next=6,e();case 6:a=r.sent,n&&(v(a),f("success")),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(3),n&&(f("error"),m(r.t0));case 13:case"end":return r.stop()}}),r,null,[[3,10]])})));return function(e){return r.apply(this,arguments)}}();return(0,i.u)((function(e){r&&w(e())}),[r]),(0,u.useEffect)((function(){return function(){f("idle"),v(null),m(null)}}),[]),{isLoading:Z,isError:b,status:o,data:d,error:x,execute:function(){return w(!0)}}}},9225:function(e,r,n){n.d(r,{u:function(){return a}});var t=n(7313);function a(e,r){var n=(0,t.useRef)(e);n.current=e;var a=(0,t.useRef)(!1);(0,t.useEffect)((function(){return a.current=!0,n.current((function(){return a.current})),function(){a.current=!1}}),r)}},8468:function(e,r,n){n.d(r,{K:function(){return u}});var t=n(7313),a=n(7890),c=n(1172);function u(){var e=(0,a.TH)(),r=e.pathname,n=e.search,u=(0,a.s0)();return[(0,t.useMemo)((function(){return c.parse(n)}),[n]),(0,t.useCallback)((function(e){u(r+"?"+c.stringify(e,{skipEmptyString:!0,skipNull:!0}),{replace:!0})}),[r,u])]}},6243:function(e,r,n){n.d(r,{db:function(){return v}});var t=n(271),a=n(4457),c=n(6797),u=n(8941).Z.firebase,i=u.apiKey,s=u.appId,o=u.databaseURL,f=u.projectId,l=u.storageBucket,p={apiKey:i,authDomain:u.authDomain,databaseURL:o,projectId:f,storageBucket:l,messagingSenderId:u.messagingSenderId,appId:s},d=(0,t.ZF)(p),v=(0,a.ad)(d);(0,c.cF)(d)},8327:function(e,r,n){n.r(r),n.d(r,{default:function(){return E}});var t=n(1413),a=n(9439),c=n(7864),u=n(7313),i=n(4511),s=n(7890),o=n(5218),f=n(8468),l=n(4165),p=n(3433),d=n(5861),v=n(4925),h=n(4457),g=n(6791),x=n(6243),m=n(887);function Z(e){var r=e.ref,n=e.offset,t=void 0===n?50:n,a=e.loading,c=e.fetchFn,i=e.canLoadMore;(0,u.useEffect)((function(){if(r.current){var e=function(e){var r=e.target,n=r.getBoundingClientRect().height;r.scrollTop+n>=r.scrollHeight-t&&i&&!a&&(null===c||void 0===c||c())};return r.current.addEventListener("scroll",e),function(){var n;null===(n=r.current)||void 0===n||n.removeEventListener("scroll",e)}}}))}var b=["execute"],w=function(e,r){if(!e)return[];var n=r===m.Hx.trade?1e3:1;switch(e){case"under_1":return[(0,h.ar)("price","<=",1*n)];case"1_2":return[(0,h.ar)("price",">=",1*n),(0,h.ar)("price","<=",2*n)];case"2_3":return[(0,h.ar)("price",">=",2*n),(0,h.ar)("price","<=",3*n)];case"3_5":return[(0,h.ar)("price",">=",3*n),(0,h.ar)("price","<=",5*n)];case"5_8":return[(0,h.ar)("price",">=",5*n),(0,h.ar)("price","<=",8*n)];case"8_15":return[(0,h.ar)("price",">=",8*n),(0,h.ar)("price","<=",15*n)];case"15_30":return[(0,h.ar)("price",">=",15*n),(0,h.ar)("price","<=",30*n)];case"upper_30":return[(0,h.ar)("price",">=",30*n)]}};var k=n(6417);function E(){var e=(0,i.$)().t,r=(0,s.TH)().pathname,n=(0,f.K)(),E=(0,a.Z)(n,2),S=E[0],R=E[1],j=(0,u.useRef)(null),I=function(e,r){var n=(0,s.TH)().pathname,c=(0,u.useState)(!0),i=(0,a.Z)(c,2),o=i[0],f=i[1],k=(0,u.useState)(void 0),E=(0,a.Z)(k,2),S=E[0],R=E[1],j=(0,u.useState)([]),I=(0,a.Z)(j,2),L=I[0],y=I[1],H=(0,g.r)((function(){return B.apply(this,arguments)}),!1),C=H.execute,_=(0,v.Z)(H,b),F=(0,u.useState)(!0),K=(0,a.Z)(F,2),N=K[0],T=K[1];Z({ref:e,canLoadMore:N,loading:_.isLoading,fetchFn:C});var M=n.startsWith("/mua-ban")?m.Hx.trade:m.Hx.rent;function B(){return(B=(0,d.Z)((0,l.Z)().mark((function e(){var n,t,a,c,u;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=[],r.ward&&n.push((0,h.ar)("ward","==",parseInt(r.ward.toString(),10))),r.district&&n.push((0,h.ar)("district","==",parseInt(r.district.toString(),10))),r.province&&n.push((0,h.ar)("province","==",parseInt(r.province.toString(),10))),S&&n.push((0,h.TQ)(S)),r.priceRange?n.unshift((0,h.Xo)("price","desc")):n.unshift((0,h.Xo)("createdAt","desc")),t=h.IO.apply(void 0,[(0,h.hJ)(x.db,"properties")].concat(n,[(0,h.ar)("published","==",!0),(0,h.ar)("action","==",M)],(0,p.Z)(w(r.priceRange,M)),[(0,h.b9)(10)])),a=[],e.next=11,(0,h.PL)(t);case 11:return c=e.sent,u=c.docs[c.docs.length-1],T(!!u),R(u),c.forEach((function(e){a.push(e.data())})),f(!1),y((function(e){return[].concat((0,p.Z)(e),a)})),e.abrupt("return",a);case 21:e.prev=21,e.t0=e.catch(0),console.log(e.t0);case 24:case"end":return e.stop()}}),e,null,[[0,21]])})))).apply(this,arguments)}var W=(0,u.useCallback)((function(){f(!0)}),[]),D=(0,u.useCallback)((function(){f(!0),R(void 0),y([])}),[]);return(0,u.useEffect)((function(){o&&C()}),[o]),(0,u.useEffect)((function(){return function(){y([]),R(void 0),T(!0),f(!0)}}),[n]),(0,u.useEffect)((function(){D()}),[r.priceRange,r.district,r.province,r.ward,D]),(0,u.useEffect)((function(){return function(){}}),[n]),(0,t.Z)((0,t.Z)({},_),{},{data:L,refetch:W,clear:D})}(j,S),L=I.isLoading,y=I.data,H=I.clear;(0,u.useEffect)((function(){document.title=r.startsWith("/mua-ban")?"Mua b\xe1n":"Cho thu\xea"}),[r]);var C=r.startsWith("/mua-ban")?m.Hx.trade:m.Hx.rent,_=S.province,F=S.district,K=S.ward,N=S.priceRange;return(0,k.jsxs)("div",{className:"p-5 flex items-center flex-col",children:[(0,k.jsx)(o.wn,{action:C,value:{province:_,district:F,ward:K,priceRange:N},onFilter:function(e){R((0,t.Z)((0,t.Z)({},S),e))},onClear:function(){R({}),H()}}),!L&&!(null!==y&&void 0!==y&&y.length)&&(0,k.jsx)(o.x4,{title:"Kh\xf4ng c\xf3 th\xf4ng tin"}),(0,k.jsxs)("div",{className:"max-w-[1000px] w-full max-h-[55vh] md:max-h-[60vh] overflow-y-auto",ref:j,children:[null===y||void 0===y?void 0:y.map((function(e){return(0,k.jsx)(o.eu,{data:e},e.id)})),L&&(0,k.jsx)(o.x4,{title:(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(c.Z7b,{className:"animate-spin"})," ",e("searching")]})})]})]})}}}]);