"use strict";(self.webpackChunkvialand=self.webpackChunkvialand||[]).push([[131],{4396:function(e,n,t){t.d(n,{pM:function(){return r},uq:function(){return a},aq:function(){return x}});var r={};t.r(r),t.d(r,{deleteById:function(){return d},deposit:function(){return o},getAll:function(){return s},getById:function(){return p},verify:function(){return l}});var a={};t.r(a),t.d(a,{pinProject:function(){return m},renewToken:function(){return h}});var i=t(8941),c=t(9869),u=i.Z.common.baseApiUrl,s=function(e){return(0,c.Z)("GET",u+"/deposit",e).then((function(e){return e.data}))},o=function(e){return(0,c.Z)("POST",u+"/deposit",e)},l=function(e){return(0,c.Z)("PATCH",u+"/deposit/".concat(e,"/verify"))},d=function(e){return(0,c.Z)("DELETE",u+"/deposit/".concat(e))},p=function(e){return(0,c.Z)("GET",u+"/deposit/".concat(e))},f=i.Z.common.baseApiUrl,h=function(){return(0,c.Z)("GET",f+"/renew")},m=function(e,n,t){return(0,c.Z)("POST",f+"/news",{fbId:e,pinned:n,projectPinnedExpiredAt:t})},x=t(1716)},9869:function(e,n,t){t.d(n,{Z:function(){return u}});var r=t(4165),a=t(5861),i=t(9489),c=t(1172);function u(e,n,t){return s.apply(this,arguments)}function s(){return(s=(0,a.Z)((0,r.Z)().mark((function e(n,t,a){var u,s,o,l,d,p,f,h,m;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=(0,i.v0)(),e.next=3,null===(u=s.currentUser)||void 0===u?void 0:u.getIdToken();case 3:return o=e.sent,l=new Headers({"Content-Type":"application/json",secret:"h6!qVM&x3Cjs@Mx9sjAF0!"}),o&&l.set("Authorization",o),d={method:n,mode:"cors",headers:l},p=t,a&&("GET"===n?(f=c.stringify(a),p+="?"+f):(d.body=a instanceof FormData?a:JSON.stringify(a),a instanceof FormData&&(d.headers={secret:"h6!qVM&x3Cjs@Mx9sjAF0!"}))),e.next=11,fetch(p,d);case 11:if(!(h=e.sent).ok){e.next=18;break}return e.next=15,h.json();case 15:return e.abrupt("return",e.sent);case 18:return e.prev=18,e.next=21,h.json();case 21:throw m=e.sent,new Error(m.message||h.statusText);case 25:throw e.prev=25,e.t0=e.catch(18),e.t0;case 28:case"end":return e.stop()}}),e,null,[[18,25]])})))).apply(this,arguments)}},1716:function(e,n,t){t.r(n),t.d(n,{deleteImages:function(){return d},deleteMany:function(){return u},deleteVideos:function(){return l},upload:function(){return c},uploadImg:function(){return s},uploadVid:function(){return o}});var r=t(8941),a=t(9869),i=r.Z.common.baseApiUrl+"/upload",c=function(e){var n=new FormData;return n.append("file",e),(0,a.Z)("POST",i,n)},u=function(e){if(e.length)return(0,a.Z)("DELETE",i,{ids:e})},s=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=new FormData;return t.append("file",e),void 0!=n.autoRotate&&t.append("autoRotate",n.autoRotate.toString()),(0,a.Z)("POST",i+"/image",t)},o=function(e,n){var t=new FormData;return t.append("file",e),t.append("newsId",n),(0,a.Z)("POST",i+"/video",t)},l=function(e){return(0,a.Z)("DELETE",i+"/videos",{ids:e})},d=function(e){return(0,a.Z)("DELETE",i+"/images",{ids:e})}},7629:function(e,n,t){t.d(n,{PU:function(){return a},vh:function(){return r}});var r="\u0110\xe3 c\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i sau \xedt ph\xfat",a="Qu\xe1 tr\xecnh t\u1ea3i l\xean \u0111\xe3 b\u1ecb l\u1ed7i. Qu\xfd kh\xe1ch vui l\xf2ng li\xean h\u1ec7 tr\u1ef1c ti\u1ebfp v\u1edbi s\u1ed1 Hotline 0868113025 (ho\u1eb7c Zalo) \u0111\u1ec3 \u0111\u01b0\u1ee3c x\u1eed l\xfd k\u1ecbp th\u1eddi"},6791:function(e,n,t){t.d(n,{r:function(){return s}});var r=t(4165),a=t(5861),i=t(9439),c=t(7313),u=t(9225);function s(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=(0,c.useState)("idle"),s=(0,i.Z)(t,2),o=s[0],l=s[1],d=(0,c.useState)(null),p=(0,i.Z)(d,2),f=p[0],h=p[1],m=(0,c.useState)(null),x=(0,i.Z)(m,2),v=x[0],g=x[1],j="pending"===o,b="error"===o,w="error"===o||"success"===o,Z=(0,c.useCallback)(function(){var n=(0,a.Z)((0,r.Z)().mark((function n(t){var a;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return l("pending"),h(null),g(null),n.prev=3,n.next=6,e();case 6:return a=n.sent,t&&(h(a),l("success")),n.abrupt("return",a);case 11:n.prev=11,n.t0=n.catch(3),t&&(l("error"),g(n.t0));case 14:case"end":return n.stop()}}),n,null,[[3,11]])})));return function(e){return n.apply(this,arguments)}}(),[e]);return(0,u.u)((function(e){n&&Z(e())}),[n]),(0,c.useEffect)((function(){return function(){l("idle"),h(null),g(null)}}),[]),{isLoading:j,isError:b,status:o,data:f,error:v,isComplete:w,execute:function(){return Z(!0)}}}},9225:function(e,n,t){t.d(n,{u:function(){return a}});var r=t(7313);function a(e,n){var t=(0,r.useRef)(e);t.current=e;var a=(0,r.useRef)(!1);(0,r.useEffect)((function(){return a.current=!0,t.current((function(){return a.current})),function(){a.current=!1}}),n)}},8468:function(e,n,t){t.d(n,{K:function(){return c}});var r=t(1172),a=t(7313),i=t(8467);function c(e){var n=(0,i.TH)(),t=n.pathname,c=n.search,u=(0,i.s0)(),s=(0,a.useMemo)((function(){return r.parse(c)}),[c]),o=(0,a.useCallback)((function(e){u(t+"?"+r.stringify(e,{skipEmptyString:!0,skipNull:!0}),{replace:!0})}),[t,u]);return(0,a.useEffect)((function(){e&&o(e)}),[]),[s,o]}},2004:function(e,n,t){t.d(n,{q:function(){return u}});var r=t(1413),a=t(5993),i=t(699),c=t(3027),u=function(e){var n=e.province,t=e.ward,u=e.district,s=i.find((function(e){return parseInt(e.id,10)===n})),o=c.find((function(e){return parseInt(e.id,10)===u})),l=a.find((function(e){return parseInt(e.id,10)===t})),d="".concat(o.typeName," ").concat(o.name.startsWith("Qu\u1eadn")?o.name.substring(5):o.name);return(0,r.Z)((0,r.Z)({},e),{},{provinceName:"".concat(s.typeName," ").concat(null===s||void 0===s?void 0:s.name),districtName:d,wardName:null===l||void 0===l?void 0:l.name})}},438:function(e,n,t){t.d(n,{D5:function(){return l},le:function(){return o},yC:function(){return s}});var r=t(3433),a=t(9548),i=t(4396),c=t(200),u=t(2004),s=function(e){var n=[],t=[];return["video","images","paymentImage"].forEach((function(a){var c=e[a];if(void 0!=c)switch(a){case"video":n.push(i.aq.deleteVideos([c.id]));break;case"images":t.push.apply(t,(0,r.Z)(c.map((function(e){return e.id}))));break;case"paymentImage":t.push(c.id)}})),n.push(i.aq.deleteImages(t)),Promise.all(n)},o=function(e){var n=e.action,t=e.houseType,r=e.width,i=e.length,s=e.address,o=r*i;o=Number.isInteger(o)?o:o.toFixed(2);var l=(0,u.q)(s),d=l.address,p=l.wardName,f=l.districtName,h=l.provinceName;return["".concat((0,a.t)(c.m3.find((function(e){return e.value===n})).name)," ").concat((0,a.t)(c.Wm.find((function(e){return e.value===t})).name)," ").concat(o,"m\xb2 (").concat(r," x ").concat(i,"m)"),"".concat(d,", ").concat(p,", ").concat(f,", ").concat(h)]};function l(e){return e<2?"under_2":e>=2&&e<5?"2_5":e>=5&&e<8?"5_8":e>=8&&e<15?"8_15":e>=15&&e<30?"15_30":"upper_30"}},4131:function(e,n,t){t.r(n),t.d(n,{default:function(){return F}});var r=t(4165),a=t(4942),i=t(1413),c=t(3433),u=t(5861),s=t(9439),o=t(3061),l=t(658),d=t.n(l),p=t(573),f=t(7313),h=t(7864),m=t(2539),x=t(8512),v=t(4396),g=t(4800),j=t(8941),b=t(5798),w=t(7629),Z=t(5831),k=t(5884),y=t(8468),N=t(5565),T=t(8469),E=t(438),D=t(4925),C=t(6791),I=t(9225),P=["execute"];var A=t(6417);function F(){var e=(0,k.P)(),n=e.isAuth,t=e.signIn,l=(0,y.K)(),F=(0,s.Z)(l,2),S=F[0],V=F[1],q=function(e){var n=e.slug,t=(0,f.useState)(void 0),a=(0,s.Z)(t,2),c=a[0],o=a[1],l=(0,f.useState)(!1),d=(0,s.Z)(l,2),h=d[0],m=d[1],x=(0,C.r)((function(){return j.apply(this,arguments)}),!1),v=x.execute,g=(0,D.Z)(x,P);function j(){return(j=(0,u.Z)((0,r.Z)().mark((function e(){var t,a,u,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.prev=1,n&&t.push((0,p.ar)("slug","==",n)),c&&!n&&t.push((0,p.TQ)(c)),a=p.IO.apply(void 0,[(0,p.hJ)(N.db,"properties"),(0,p.Xo)("createdAt","desc")].concat(t,[(0,p.b9)(50)])),u=[],e.next=8,(0,p.PL)(a);case 8:return s=e.sent,o(s.docs[s.docs.length-1]),s.forEach((function(e){u.push((0,i.Z)({id:e.id},e.data()))})),e.abrupt("return",u);case 14:return e.prev=14,e.t0=e.catch(1),e.abrupt("return",[]);case 17:case"end":return e.stop()}}),e,null,[[1,14]])})))).apply(this,arguments)}var b=(0,f.useCallback)((function(){m(!1)}),[]),w=(0,f.useCallback)((function(){o(void 0),m(!1)}),[]);return(0,I.u)((function(e){!h&&e()&&(v(),m(!0))}),[h]),(0,i.Z)((0,i.Z)({},g),{},{refetch:b,clear:w})}({slug:S.slug}),H=q.isLoading,L=q.data,M=q.refetch,O=q.clear,G=(0,f.useState)([]),R=(0,s.Z)(G,2),U=R[0],_=R[1],B=(0,Z.s)().socket;(0,f.useEffect)((function(){_(null!==L&&void 0!==L?L:[])}),[L]);var J=(0,f.useRef)(null),Q=(0,f.useCallback)(function(){var e=(0,u.Z)((0,r.Z)().mark((function e(n,t){var u,s,o,l,d=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=d.length>2&&void 0!==d[2]?d[2]:{},s=(0,c.Z)(U),!((o=s.findIndex((function(e){return e.id===n})))>-1)){e.next=18;break}return s[o]=(0,i.Z)((0,i.Z)({},s[o]),{},(0,a.Z)({},t,!s[o][t]),u),_(s),e.prev=6,l=(0,p.JU)(N.db,"properties",n),e.next=10,(0,p.pl)(l,s[o]);case 10:x.Am.success("Thao t\xe1c th\xe0nh c\xf4ng"),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(6),s[o][t]=!s[o][t],_(s);case 18:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(n,t){return e.apply(this,arguments)}}(),[U]),Y=(0,f.useCallback)(function(){var e=(0,u.Z)((0,r.Z)().mark((function e(n){var t,a,i,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,c.Z)(U),!((a=t.findIndex((function(e){return e.id===n})))>-1)){e.next=9;break}return i=(0,p.JU)(N.db,"properties",n),u=Promise.all([(0,p.oe)(i),(0,E.yC)(t[a])]),e.next=7,x.Am.promise(u,{pending:"\u0110ang x\xf3a b\xe0i \u0111\u0103ng",success:"X\xf3a b\xe0i \u0111\u0103ng th\xe0nh c\xf4ng",error:w.vh});case 7:t.splice(a,1),_(t);case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[U]),z=(0,f.useCallback)(function(){var e=(0,u.Z)((0,r.Z)().mark((function e(n){var t,a,i,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,c.Z)(U),!((a=t.findIndex((function(e){return e.id===n})))>-1)){e.next=14;break}return e.prev=3,i=t[a].video,t[a].video=null,u=(0,p.JU)(N.db,"properties",n),e.next=9,x.Am.promise(Promise.all([(0,p.pl)(u,t[a]),v.aq.deleteVideos([i.id])]),{pending:"\u0110ang x\xf3a video",success:"X\xf3a video th\xe0nh c\xf4ng",error:w.vh});case 9:_(t),e.next=14;break;case 12:e.prev=12,e.t0=e.catch(3);case 14:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(n){return e.apply(this,arguments)}}(),[U]),K=function(){var e=(0,u.Z)((0,r.Z)().mark((function e(){var n,t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.uq.renewToken();case 3:n=e.sent,t=n.data,setTimeout((function(){window.open(t,"_blank","resizable=yes,top=200,left=200,width=480,height=640")}),0),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=(0,u.Z)((0,r.Z)().mark((function e(n,t){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=d()().add(j.Z.common.pinnedProjectExpirationH,"hours"),e.next=4,Q(n,"projectPinned",{projectPinnedExpiredAt:a.unix()});case 4:return e.next=6,v.uq.pinProject(n,t,a.toDate());case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(n,t){return e.apply(this,arguments)}}();return(0,f.useEffect)((function(){S.slug&&(J.current.value=S.slug)}),[S.slug]),(0,A.jsxs)("div",{className:"min-h-screen p-5",children:[(0,A.jsx)("h1",{className:"font-medium text-base md:text-lg mb-5",children:"Danh s\xe1ch tin"}),(0,A.jsxs)("div",{className:"w-full",children:[(0,A.jsxs)("div",{className:"flex my-2 gap-2 flex-wrap",children:[(0,A.jsx)("input",{ref:J,placeholder:"Nh\u1eadp ID c\u1ea7n tra c\u1ee9u",type:"text",className:"input max-w-[400px] w-full"}),(0,A.jsxs)("button",{onClick:function(){V({slug:J.current.value}),M()},className:"btn",children:[(0,A.jsx)(h.RB5,{}),(0,A.jsx)("span",{children:"Tra c\u1ee9u"})]}),!n&&(0,A.jsx)("button",{onClick:t,className:"btn btn--secondary",children:(0,A.jsx)("span",{children:"\u0110\u0103ng nh\u1eadp"})}),(0,A.jsx)("div",{className:"flex-grow"}),(0,A.jsxs)("button",{onClick:function(){O()},className:"btn",children:[(0,A.jsx)(h.Em2,{}),(0,A.jsx)("span",{children:"Refresh"})]}),(0,A.jsxs)("button",{onClick:K,className:"btn",children:[(0,A.jsx)(h.IDO,{}),(0,A.jsx)("span",{children:"L\xe0m m\u1edbi token"})]})]}),(0,A.jsx)("div",{className:"overflow-auto",children:(0,A.jsxs)("table",{className:"table-auto",children:[(0,A.jsx)("thead",{children:(0,A.jsxs)("tr",{children:[(0,A.jsx)("th",{className:"min-w-[200px] max-w-[300px]",children:"T\xean"}),(0,A.jsx)("th",{className:"min-w-[130px] max-w-[300px]",children:"Ng\xe0y \u0111\u0103ng"}),(0,A.jsx)("th",{className:"min-w-[130px] max-w-[300px]",children:"\u1ea2nh thanh to\xe1n"}),(0,A.jsx)("th",{className:"min-w-[130px] max-w-[300px]",children:"Link video"}),(0,A.jsx)("th",{className:"min-w-[130px] max-w-[300px]",children:"Thao t\xe1c video"}),(0,A.jsx)("th",{className:"min-w-[130px] max-w-[300px]",children:"Thao t\xe1c b\xe0i \u0111\u0103ng"}),(0,A.jsx)("th",{className:"min-w-[130px] max-w-[300px]",children:"Ghim trang ch\u1ee7"}),(0,A.jsx)("th",{className:"min-w-[130px] max-w-[300px]",children:"Ghim d\u1ef1 \xe1n"})]})}),(0,A.jsx)("tbody",{children:null!==U&&void 0!==U&&U.length?(0,A.jsx)(A.Fragment,{children:null===U||void 0===U?void 0:U.map((function(e){var n=e.id,t=e.subject,r=e.video,a=e.createdAt,i=e.hideVideo,c=e.published,u=e.paymentImage,s=e.featurePinned,o=e.projectPinned,l=e.projectPinnedExpiredAt;return(0,A.jsxs)("tr",{className:"hover:bg-gray-100 cursor-default",children:[(0,A.jsx)("td",{children:(0,A.jsxs)("div",{className:"flex items-center",children:[o&&(0,A.jsx)(h.pHD,{className:"flex-shrink-0 text-yellow-500 text-lg"}),(0,A.jsx)("p",{className:"text-sm mx-auto",children:t})]})}),(0,A.jsx)("td",{children:(0,A.jsx)("p",{className:"mx-auto text-sm",children:d()(1e3*a).format("DD/MM/YYYY - HH:mm")})}),(0,A.jsx)("td",{children:u?(0,A.jsx)(g.Ee,{title:"\u1ea2nh thanh to\xe1n",className:"relative mx-auto w-[150px] h-[150px] object-cover",src:(0,T.QW)(u.id)}):"---"}),(0,A.jsx)("td",{children:r?(0,A.jsx)("div",{className:"relative mx-auto w-[192px] aspect-video",children:(0,A.jsx)("iframe",{style:{width:"inherit"},title:r.id,src:"https://customer-eyo251alucwnligs.cloudflarestream.com/".concat(r.id,"/iframe?poster=https%3A%2F%2Fcustomer-eyo251alucwnligs.cloudflarestream.com%2F").concat(r.id,"%2Fthumbnails%2Fthumbnail.jpg%3Ftime%3D%26height%3D600"),loading:"lazy",allow:"accelerometer; gyroscope; autoplay; encrypted-media; picture-in-picture;"})}):"---"}),(0,A.jsx)("td",{children:(0,A.jsx)(g.o1,{toggleText:i?"Hi\u1ec7n":"\u1ea8n",hideToggle:!r,disableDelete:!r,booleanVal:i,onDelete:function(){return z(n)},onToggle:function(){return Q(n,"hideVideo")}})}),(0,A.jsx)("td",{children:(0,A.jsx)(g.o1,{toggleText:c?"\u1ea8n":"Hi\u1ec7n",booleanVal:!c,onDelete:function(){return Y(n)},onToggle:function(){Q(n,"published"),c||B.emit(b.Q.verifyNews,n)}})}),(0,A.jsx)("td",{children:(0,A.jsx)(g.o1,{toggleText:s?"B\u1ecf ghim":"Ghim",booleanVal:!s,onToggle:function(){return Q(n,"featurePinned")}})}),(0,A.jsxs)("td",{children:[(0,A.jsx)(g.o1,{toggleText:o?"B\u1ecf ghim":"Ghim",booleanVal:!o,onToggle:function(){return W(n,!o)}}),l&&o&&new Date(1e3*l)>new Date&&(0,A.jsx)(g.B7,{deadline:1e3*l})]})]},n)}))}):(0,A.jsx)("tr",{className:"text-center",children:(0,A.jsx)("td",{colSpan:100,children:H?"Loading...":"Kh\xf4ng c\xf3 data"})})})]})}),(0,A.jsxs)("div",{className:"flex gap-3 mt-5",children:[(0,A.jsxs)("button",{className:"btn",onClick:O,children:[(0,A.jsx)(m.b2E,{}),"Trang \u0111\u1ea7u"]}),(0,A.jsxs)("button",{className:(0,o.Z)("btn",!(null!==L&&void 0!==L&&L.length)||L.length<50&&"btn--disabled"),onClick:M,children:["Trang sau",(0,A.jsx)(m.sOJ,{})]})]})]})]})}}}]);