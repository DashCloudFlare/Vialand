"use strict";(self.webpackChunkvialand=self.webpackChunkvialand||[]).push([[340],{4396:function(n,e,t){t.d(e,{pM:function(){return r},Cj:function(){return h.Cj},cx:function(){return f},$m:function(){return d},EC:function(){return p}});var r={};t.r(r),t.d(r,{deposit:function(){return u},getAll:function(){return s},verify:function(){return o}});var c=t(8941),i=t(9869),a=c.Z.common.baseApiUrl,s=function(n){return(0,i.Z)("GET",a+"/deposit",n).then((function(n){return n.data}))},u=function(n){return(0,i.Z)("POST",a+"/deposit",n)},o=function(n){return(0,i.Z)("PATCH",a+"/deposit/".concat(n,"/verify"))},l=(t(3531),c.Z.common.baseApiUrl),d=function(){return(0,i.Z)("GET",l+"/renew")},f=function(n,e,t){return(0,i.Z)("POST",l+"/news",{fbId:n,pinned:e,projectPinnedExpiredAt:t})},p=function(){return(0,i.Z)("POST",l+"/news/sync")},h=t(1716)},1716:function(n,e,t){t.d(e,{Cj:function(){return u},Pe:function(){return o},hF:function(){return l},ws:function(){return a},wt:function(){return s}});var r=t(8941),c=t(9869),i=r.Z.common.baseApiUrl+"/upload",a=function(n){var e=new FormData;return e.append("file",n),(0,c.Z)("POST",i,e)},s=function(n){return(0,c.Z)("DELETE",i,{ids:n})},u=function(n){var e=new FormData;return e.append("file",n),(0,c.Z)("POST",i+"/google-img",e)},o=function(n,e){var t=new FormData;return t.append("file",n),t.append("newsId",e),(0,c.Z)("POST",i+"/google-vid",t)},l=function(n){return(0,c.Z)("DELETE",i+"/google",{ids:n})}},7629:function(n,e,t){t.d(e,{PU:function(){return i},ZE:function(){return c},vh:function(){return r}});var r="\u0110\xe3 c\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i sau \xedt ph\xfat",c="\u0110\xe3 c\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng li\xean h\u1ec7 qu\u1ea3n tr\u1ecb vi\xean",i="Qu\xe1 tr\xecnh t\u1ea3i l\xean \u0111\xe3 b\u1ecb l\u1ed7i. Qu\xfd kh\xe1ch vui l\xf2ng li\xean h\u1ec7 tr\u1ef1c ti\u1ebfp v\u1edbi s\u1ed1 Hotline 0868113025 (ho\u1eb7c Zalo) \u0111\u1ec3 \u0111\u01b0\u1ee3c x\u1eed l\xfd k\u1ecbp th\u1eddi"},6791:function(n,e,t){t.d(e,{r:function(){return u}});var r=t(4165),c=t(5861),i=t(9439),a=t(7313),s=t(9225);function u(n){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=(0,a.useState)("idle"),u=(0,i.Z)(t,2),o=u[0],l=u[1],d=(0,a.useState)(null),f=(0,i.Z)(d,2),p=f[0],h=f[1],x=(0,a.useState)(null),m=(0,i.Z)(x,2),v=m[0],g=m[1],b="pending"===o,j="error"===o,w=(0,a.useCallback)(function(){var e=(0,c.Z)((0,r.Z)().mark((function e(t){var c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l("pending"),h(null),g(null),e.prev=3,e.next=6,n();case 6:return c=e.sent,t&&(h(c),l("success")),e.abrupt("return",c);case 11:e.prev=11,e.t0=e.catch(3),t&&(l("error"),g(e.t0));case 14:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(n){return e.apply(this,arguments)}}(),[n]);return(0,s.u)((function(n){e&&w(n())}),[e]),(0,a.useEffect)((function(){return function(){l("idle"),h(null),g(null)}}),[]),{isLoading:b,isError:j,status:o,data:p,error:v,execute:function(){return w(!0)}}}},9225:function(n,e,t){t.d(e,{u:function(){return c}});var r=t(7313);function c(n,e){var t=(0,r.useRef)(n);t.current=n;var c=(0,r.useRef)(!1);(0,r.useEffect)((function(){return c.current=!0,t.current((function(){return c.current})),function(){c.current=!1}}),e)}},8468:function(n,e,t){t.d(e,{K:function(){return a}});var r=t(1172),c=t(7313),i=t(7890);function a(n){var e=(0,i.TH)(),t=e.pathname,a=e.search,s=(0,i.s0)(),u=(0,c.useMemo)((function(){return r.parse(a)}),[a]),o=(0,c.useCallback)((function(n){s(t+"?"+r.stringify(n,{skipEmptyString:!0,skipNull:!0}),{replace:!0})}),[t,s]);return(0,c.useEffect)((function(){n&&o(n)}),[]),[u,o]}},5340:function(n,e,t){t.r(e),t.d(e,{default:function(){return L}});var r=t(4165),c=t(4942),i=t(1413),a=t(3433),s=t(5861),u=t(9439),o=t(3061),l=t(658),d=t.n(l),f=t(573),p=t(7313),h=t(7864),x=t(2539),m=t(8512),v=t(4396),g=t(1110),b=t(8941),j=t(5798),w=t(7629),Z=t(5857),k=t(5831),N=t(8468),E=t(5565),T=t(1716),y=function(n,e){return fetch("https://www.googleapis.com/drive/v3/files/".concat(n),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}}).then((function(){return!0})).catch((function(){return!1}))},C=function(n,e){return n.fromSA?(0,T.hF)([n.id]):y(n.id,e)},A=function(n,e){var t=[];["video","images","paymentImage"].forEach((function(e){var r=n[e];void 0!=r&&t.push(r)}));var r=[],c=[];return t.flat(1).forEach((function(n){n.fromSA?r.push(n.id):c.push(n.id)})),c.map((function(n){return y(n,e)})).concat((0,T.hF)(r))},P=t(8469),D=t(4925),S=t(6791),I=t(9225),O=["execute"];var H=t(6417);function L(){var n=(0,Z.Eu)().getAccessToken,e=(0,N.K)(),t=(0,u.Z)(e,2),l=t[0],T=t[1],y=function(n){var e=n.slug,t=(0,p.useState)(void 0),c=(0,u.Z)(t,2),a=c[0],o=c[1],l=(0,p.useState)(!1),d=(0,u.Z)(l,2),h=d[0],x=d[1],m=(0,S.r)((function(){return b.apply(this,arguments)}),!1),v=m.execute,g=(0,D.Z)(m,O);function b(){return(b=(0,s.Z)((0,r.Z)().mark((function n(){var t,c,s,u;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=[],n.prev=1,e&&t.push((0,f.ar)("slug","==",e)),a&&!e&&t.push((0,f.TQ)(a)),c=f.IO.apply(void 0,[(0,f.hJ)(E.db,"properties"),(0,f.Xo)("createdAt","desc")].concat(t,[(0,f.b9)(50)])),s=[],n.next=8,(0,f.PL)(c);case 8:return u=n.sent,o(u.docs[u.docs.length-1]),u.forEach((function(n){s.push((0,i.Z)({id:n.id},n.data()))})),n.abrupt("return",s);case 14:return n.prev=14,n.t0=n.catch(1),n.abrupt("return",[]);case 17:case"end":return n.stop()}}),n,null,[[1,14]])})))).apply(this,arguments)}var j=(0,p.useCallback)((function(){x(!1)}),[]),w=(0,p.useCallback)((function(){o(void 0),x(!1)}),[]);return(0,I.u)((function(n){!h&&n()&&(v(),x(!0))}),[h]),(0,i.Z)((0,i.Z)({},g),{},{refetch:j,clear:w})}({slug:l.slug}),L=y.isLoading,U=y.data,F=y.refetch,G=y.clear,V=(0,p.useState)([]),B=(0,u.Z)(V,2),J=B[0],R=B[1],M=(0,k.s)().socket;(0,p.useEffect)((function(){R(null!==U&&void 0!==U?U:[])}),[U]);var Q=(0,p.useRef)(null),X=(0,p.useCallback)(function(){var n=(0,s.Z)((0,r.Z)().mark((function n(e,t){var s,u,o,l,d=arguments;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=d.length>2&&void 0!==d[2]?d[2]:{},u=(0,a.Z)(J),!((o=u.findIndex((function(n){return n.id===e})))>-1)){n.next=18;break}return u[o]=(0,i.Z)((0,i.Z)({},u[o]),{},(0,c.Z)({},t,!u[o][t]),s),R(u),n.prev=6,l=(0,f.JU)(E.db,"properties",e),n.next=10,(0,f.pl)(l,u[o]);case 10:m.Am.success("Thao t\xe1c th\xe0nh c\xf4ng"),n.next=18;break;case 13:n.prev=13,n.t0=n.catch(6),u[o][t]=!u[o][t],R(u);case 18:case"end":return n.stop()}}),n,null,[[6,13]])})));return function(e,t){return n.apply(this,arguments)}}(),[J]),Y=(0,p.useCallback)(function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var c,i,s,u,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n();case 2:if(c=e.sent){e.next=6;break}return m.Am.warn(w.ZE),e.abrupt("return");case 6:if(i=(0,a.Z)(J),!((s=i.findIndex((function(n){return n.id===t})))>-1)){e.next=15;break}return u=(0,f.JU)(E.db,"properties",t),o=Promise.all([(0,f.oe)(u)].concat(A(i[s],c))),e.next=13,m.Am.promise(o,{pending:"\u0110ang x\xf3a b\xe0i \u0111\u0103ng",success:"X\xf3a b\xe0i \u0111\u0103ng th\xe0nh c\xf4ng",error:w.vh});case 13:i.splice(s,1),R(i);case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[J,n]),K=(0,p.useCallback)(function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t){var c,i,s,u,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n();case 2:if(c=e.sent){e.next=6;break}return m.Am.warn(w.ZE),e.abrupt("return");case 6:if(i=(0,a.Z)(J),!((s=i.findIndex((function(n){return n.id===t})))>-1)){e.next=20;break}return e.prev=9,u=i[s].video,i[s].video=null,o=(0,f.JU)(E.db,"properties",t),e.next=15,m.Am.promise(Promise.all([(0,f.pl)(o,i[s]),C(u,c)]),{pending:"\u0110ang x\xf3a video",success:"X\xf3a video th\xe0nh c\xf4ng",error:w.vh});case 15:R(i),e.next=20;break;case 18:e.prev=18,e.t0=e.catch(9);case 20:case"end":return e.stop()}}),e,null,[[9,18]])})));return function(n){return e.apply(this,arguments)}}(),[J,n]),z=function(){var n=(0,s.Z)((0,r.Z)().mark((function n(){var e,t;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,v.$m)();case 3:e=n.sent,t=e.data,200===e.status&&setTimeout((function(){window.open(t,"_blank","resizable=yes,top=200,left=200,width=480,height=640")}),0),n.next=11;break;case 9:n.prev=9,n.t0=n.catch(0);case 11:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(){return n.apply(this,arguments)}}(),$=function(){var n=(0,s.Z)((0,r.Z)().mark((function n(e,t){var c;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,c=d()().add(b.Z.common.pinnedProjectExpirationH,"hours"),n.next=4,X(e,"projectPinned",{projectPinnedExpiredAt:c.unix()});case 4:return n.next=6,(0,v.cx)(e,t,c.toDate());case 6:n.next=10;break;case 8:n.prev=8,n.t0=n.catch(0);case 10:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e,t){return n.apply(this,arguments)}}();return(0,p.useEffect)((function(){l.slug&&(Q.current.value=l.slug)}),[l.slug]),(0,H.jsxs)("div",{className:"min-h-screen p-5",children:[(0,H.jsx)("h1",{className:"font-medium text-base md:text-lg mb-5",children:"Danh s\xe1ch tin"}),(0,H.jsxs)("div",{className:"w-full",children:[(0,H.jsxs)("div",{className:"flex my-2 gap-2 flex-wrap",children:[(0,H.jsx)("input",{ref:Q,placeholder:"Nh\u1eadp ID c\u1ea7n tra c\u1ee9u",type:"text",className:"input max-w-[400px] w-full"}),(0,H.jsxs)("button",{onClick:function(n){Q.current.value&&(T({slug:Q.current.value}),F())},className:"btn",children:[(0,H.jsx)(h.RB5,{}),(0,H.jsx)("span",{children:"Tra c\u1ee9u"})]}),(0,H.jsxs)("button",{onClick:function(){Q.current&&(l.slug&&G(),Q.current.value="",T({}))},className:"btn btn--secondary",children:[(0,H.jsx)(h.oHP,{}),(0,H.jsx)("span",{children:"X\xf3a"})]}),(0,H.jsx)("div",{className:"flex-grow"}),(0,H.jsxs)("button",{onClick:function(){m.Am.promise((0,v.EC)(),{pending:"\u0110ang \u0111\u1ed3ng b\u1ed9",success:"\u0110\u1ed3ng b\u1ed9 tin th\xe0nh c\xf4ng",error:"\u0110\u1ed3ng b\u1ed9 tin th\u1ea5t b\u1ea1i"})},className:"btn",children:[(0,H.jsx)(h.IDO,{}),(0,H.jsx)("span",{children:"\u0110\u1ed3ng b\u1ed9"})]}),(0,H.jsxs)("button",{onClick:function(){G()},className:"btn",children:[(0,H.jsx)(h.Em2,{}),(0,H.jsx)("span",{children:"Refresh"})]}),(0,H.jsxs)("button",{onClick:z,className:"btn",children:[(0,H.jsx)(h.IDO,{}),(0,H.jsx)("span",{children:"L\xe0m m\u1edbi token"})]})]}),(0,H.jsx)("div",{className:"overflow-auto",children:(0,H.jsxs)("table",{className:"table-auto",children:[(0,H.jsx)("thead",{children:(0,H.jsxs)("tr",{children:[(0,H.jsx)("th",{className:"min-w-[200px] max-w-[300px]",children:"T\xean"}),(0,H.jsx)("th",{className:"min-w-[130px] max-w-[300px]",children:"Ng\xe0y \u0111\u0103ng"}),(0,H.jsx)("th",{className:"min-w-[130px] max-w-[300px]",children:"\u1ea2nh thanh to\xe1n"}),(0,H.jsx)("th",{className:"min-w-[130px] max-w-[300px]",children:"Link video"}),(0,H.jsx)("th",{className:"min-w-[130px] max-w-[300px]",children:"Thao t\xe1c video"}),(0,H.jsx)("th",{className:"min-w-[130px] max-w-[300px]",children:"Thao t\xe1c b\xe0i \u0111\u0103ng"}),(0,H.jsx)("th",{className:"min-w-[130px] max-w-[300px]",children:"Ghim trang ch\u1ee7"}),(0,H.jsx)("th",{className:"min-w-[130px] max-w-[300px]",children:"Ghim d\u1ef1 \xe1n"})]})}),(0,H.jsx)("tbody",{children:null!==J&&void 0!==J&&J.length?(0,H.jsx)(H.Fragment,{children:null===J||void 0===J?void 0:J.map((function(n){var e=n.id,t=n.subject,r=n.video,c=n.createdAt,i=n.hideVideo,a=n.published,s=n.paymentImage,u=n.featurePinned,o=n.projectPinned,l=n.projectPinnedExpiredAt;return(0,H.jsxs)("tr",{className:"hover:bg-gray-100 cursor-default",children:[(0,H.jsx)("td",{children:(0,H.jsxs)("div",{className:"flex items-center",children:[o&&(0,H.jsx)(h.pHD,{className:"flex-shrink-0 text-yellow-500 text-lg"}),(0,H.jsx)("p",{className:"text-sm mx-auto",children:t})]})}),(0,H.jsx)("td",{children:(0,H.jsx)("p",{className:"mx-auto text-sm",children:d()(1e3*c).format("DD/MM/YYYY - HH:mm")})}),(0,H.jsx)("td",{children:s?(0,H.jsx)(g.Ee,{title:"\u1ea2nh thanh to\xe1n",className:"relative mx-auto w-[150px] h-[150px] object-cover",src:(0,P.OD)(s.id)}):"---"}),(0,H.jsx)("td",{children:r?(0,H.jsx)("div",{className:"relative mx-auto w-[192px] aspect-video",children:(0,H.jsx)("video",{controls:!0,preload:"none",title:"video",children:(0,H.jsx)("source",{src:"".concat(b.Z.common.baseApiUrl,"/google/video/").concat(r.id),type:"video/mp4"})})}):"---"}),(0,H.jsx)("td",{children:(0,H.jsx)(g.o1,{toggleText:i?"Hi\u1ec7n":"\u1ea8n",hideToggle:!r,disableDelete:!r,booleanVal:i,onDelete:function(){return K(e)},onToggle:function(){return X(e,"hideVideo")}})}),(0,H.jsx)("td",{children:(0,H.jsx)(g.o1,{toggleText:a?"\u1ea8n":"Hi\u1ec7n",booleanVal:!a,onDelete:function(){return Y(e)},onToggle:function(){X(e,"published"),a||M.emit(j.Q.verifyNews,e)}})}),(0,H.jsx)("td",{children:(0,H.jsx)(g.o1,{toggleText:u?"B\u1ecf ghim":"Ghim",booleanVal:!u,onToggle:function(){return X(e,"featurePinned")}})}),(0,H.jsxs)("td",{children:[(0,H.jsx)(g.o1,{toggleText:o?"B\u1ecf ghim":"Ghim",booleanVal:!o,onToggle:function(){return $(e,!o)}}),l&&o&&new Date(1e3*l)>new Date&&(0,H.jsx)(g.B7,{deadline:1e3*l})]})]},e)}))}):(0,H.jsx)("tr",{className:"text-center",children:(0,H.jsx)("td",{colSpan:100,children:L?"Loading...":"Kh\xf4ng c\xf3 data"})})})]})}),(0,H.jsxs)("div",{className:"flex gap-3 mt-5",children:[(0,H.jsxs)("button",{className:"btn",onClick:G,children:[(0,H.jsx)(x.b2E,{}),"Trang \u0111\u1ea7u"]}),(0,H.jsxs)("button",{className:(0,o.Z)("btn",!(null!==U&&void 0!==U&&U.length)||U.length<50&&"btn--disabled"),onClick:F,children:["Trang sau",(0,H.jsx)(x.sOJ,{})]})]})]})]})}}}]);