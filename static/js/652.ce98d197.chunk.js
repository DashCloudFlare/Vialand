"use strict";(self.webpackChunkvialand=self.webpackChunkvialand||[]).push([[652,974],{7629:function(e,n,t){t.d(n,{PU:function(){return s},ZE:function(){return u},vh:function(){return r}});var r="\u0110\xe3 c\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng th\u1eed l\u1ea1i sau \xedt ph\xfat",u="\u0110\xe3 c\xf3 l\u1ed7i x\u1ea3y ra, vui l\xf2ng li\xean h\u1ec7 qu\u1ea3n tr\u1ecb vi\xean",s="Qu\xe1 tr\xecnh t\u1ea3i l\xean \u0111\xe3 b\u1ecb l\u1ed7i. Qu\xfd kh\xe1ch vui l\xf2ng li\xean h\u1ec7 tr\u1ef1c ti\u1ebfp v\u1edbi s\u1ed1 Hotline 0868113025 (ho\u1eb7c Zalo) \u0111\u1ec3 \u0111\u01b0\u1ee3c x\u1eed l\xfd k\u1ecbp th\u1eddi"},6791:function(e,n,t){t.d(n,{r:function(){return i}});var r=t(4165),u=t(5861),s=t(9439),c=t(7313),a=t(9225);function i(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=(0,c.useState)("idle"),i=(0,s.Z)(t,2),l=i[0],o=i[1],f=(0,c.useState)(null),d=(0,s.Z)(f,2),p=d[0],h=d[1],v=(0,c.useState)(null),x=(0,s.Z)(v,2),m=x[0],g=x[1],b="pending"===l,Z="error"===l,N=(0,c.useCallback)(function(){var n=(0,u.Z)((0,r.Z)().mark((function n(t){var u;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o("pending"),h(null),g(null),n.prev=3,n.next=6,e();case 6:return u=n.sent,t&&(h(u),o("success")),n.abrupt("return",u);case 11:n.prev=11,n.t0=n.catch(3),t&&(o("error"),g(n.t0));case 14:case"end":return n.stop()}}),n,null,[[3,11]])})));return function(e){return n.apply(this,arguments)}}(),[e]);return(0,a.u)((function(e){n&&N(e())}),[n]),(0,c.useEffect)((function(){return function(){o("idle"),h(null),g(null)}}),[]),{isLoading:b,isError:Z,status:l,data:p,error:m,execute:function(){return N(!0)}}}},3737:function(e,n,t){t.d(n,{M:function(){return s}});var r=t(9439),u=t(7313);function s(e){var n=e.ref,t=e.offset,s=void 0===t?50:t,c=e.loading,a=e.canLoadMore,i=e.fetchFn,l=(0,u.useState)(!1),o=(0,r.Z)(l,2),f=o[0],d=o[1];(0,u.useEffect)((function(){if(null!==n&&void 0!==n&&n.current){var e=function(e){var n=e.target,t=n.getBoundingClientRect().height;n.scrollTop+t>=n.scrollHeight-s?d(!0):d(!1)};return null===n||void 0===n||n.current.addEventListener("scroll",e),function(){var t;null===n||void 0===n||null===(t=n.current)||void 0===t||t.removeEventListener("scroll",e)}}if(document){var t=function(e){var n=e.currentTarget,t=n.getElementById("footer"),r=n.scrollingElement,u=r.scrollHeight,c=r.scrollTop,a=r.clientHeight;Math.abs(u-a-c)<t.getBoundingClientRect().height+s?d(!0):d(!1)};return document.addEventListener("scroll",t),function(){document.removeEventListener("scroll",t)}}}),[]),(0,u.useEffect)((function(){f&&!c&&a&&(null===i||void 0===i||i())}),[f])}},9225:function(e,n,t){t.d(n,{u:function(){return u}});var r=t(7313);function u(e,n){var t=(0,r.useRef)(e);t.current=e;var u=(0,r.useRef)(!1);(0,r.useEffect)((function(){return u.current=!0,t.current((function(){return u.current})),function(){u.current=!1}}),n)}},8468:function(e,n,t){t.d(n,{K:function(){return c}});var r=t(1172),u=t(7313),s=t(7890);function c(e){var n=(0,s.TH)(),t=n.pathname,c=n.search,a=(0,s.s0)(),i=(0,u.useMemo)((function(){return r.parse(c)}),[c]),l=(0,u.useCallback)((function(e){a(t+"?"+r.stringify(e,{skipEmptyString:!0,skipNull:!0}),{replace:!0})}),[t,a]);return(0,u.useEffect)((function(){e&&l(e)}),[]),[i,l]}},3974:function(e,n,t){t.r(n),t.d(n,{default:function(){return E}});var r=t(9439),u=t(3061),s=t(7313),c=t(4511),a=t(7864),i=t(8512),l=t(1110),o=t(8468),f=t(3433),d=t(4165),p=t(1413),h=t(5861),v=t(4925),x=t(573),m=t(6404),g=t(7629),b=t(5884),Z=t(6791),N=t(3737),w=t(5565),j=["execute"];var y=t(6417),k=(0,s.memo)((function(e){var n=e.user,t=e.data,r=void 0===t?[]:t,u=e.pushNews;return(0,y.jsx)(y.Fragment,{children:r.map((function(e){return(0,y.jsx)(l.eu,{data:e,user:n,onPushNews:u},e.id)}))})}));function E(e){var n=e.readOnly,t=void 0!==n&&n,E=e.user,L=(0,c.$)().t,S=(0,s.useRef)(null),_=(0,s.useRef)(null),C=(0,o.K)(),P=(0,r.Z)(C,2),R=P[0],T=P[1],M=function(e,n,t){var u=(0,b.P)().refetchProfile,a=(0,c.$)().t,l=(0,s.useState)(!1),o=(0,r.Z)(l,2),y=o[0],k=o[1],E=(0,s.useState)([]),L=(0,r.Z)(E,2),S=L[0],_=L[1],C=(0,s.useState)(void 0),P=(0,r.Z)(C,2),R=P[0],T=P[1],M=(0,Z.r)((function(){return V.apply(this,arguments)}),!1),A=M.execute,H=(0,v.Z)(M,j);function U(){return(U=(0,h.Z)((0,d.Z)().mark((function e(){var n;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A();case 3:(n=e.sent)&&_((function(e){return[].concat((0,f.Z)(e),(0,f.Z)(n))})),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function V(){return(V=(0,h.Z)((0,d.Z)().mark((function e(){var r,u,s,c,a;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=[],n&&r.push((0,x.ar)("contactNumber","==",n)),R&&r.push((0,x.TQ)(R)),t||r.push((0,x.ar)("published","==",!0),(0,x.b9)(10)),u=x.IO.apply(void 0,[(0,x.hJ)(w.db,"properties"),(0,x.Xo)("createdAt","desc")].concat(r)),s=[],e.next=9,(0,x.PL)(u);case 9:return c=e.sent,a=c.docs[c.docs.length-1],c.forEach((function(e){s.push((0,p.Z)({id:e.id},e.data()))})),T(a),k(!1),e.abrupt("return",s);case 17:e.prev=17,e.t0=e.catch(0);case 19:case"end":return e.stop()}}),e,null,[[0,17]])})))).apply(this,arguments)}(0,N.M)({ref:e,canLoadMore:!!R,loading:H.isLoading,fetchFn:function(){return U.apply(this,arguments)}});var B=function(){var e=(0,h.Z)((0,d.Z)().mark((function e(n,r){var s,c,l,o,f,v,b;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=29;break}return s=(0,x.JU)(w.db,"profiles",t.uid),e.next=4,(0,x.QT)(s);case 4:if((c=e.sent).exists()){e.next=9;break}return i.Am.error(g.PU),r(),e.abrupt("return");case 9:if(l=c.data(),!((o=l.coins)<m.z1)){e.next=14;break}return i.Am.error(a("not_enough_money_please_deposit_more")),r(),e.abrupt("return");case 14:if(f=S.slice(),!((v=f.findIndex((function(e){return e.id===n.id})))>-1)){e.next=29;break}return f[v]=(0,p.Z)((0,p.Z)({},f[v]),{},{published:!0}),e.prev=18,b=(0,x.JU)(w.db,"properties",n.id),e.next=22,(0,x.i3)(w.db,function(){var e=(0,h.Z)((0,d.Z)().mark((function e(n){return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.set(b,f[v]),n.set(s,{coins:o-m.z1});case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 22:return e.next=24,u();case 24:i.Am.success(a("push_news_successfully")),_(f);case 26:return e.prev=26,r(),e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[18,,26,29]])})));return function(n,t){return e.apply(this,arguments)}}(),K=(0,s.useCallback)((function(){_([]),T(void 0),k(!0)}),[]);return(0,s.useEffect)((function(){K()}),[n]),(0,s.useEffect)((function(){function e(){return(e=(0,h.Z)((0,d.Z)().mark((function e(){var n;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A();case 2:n=e.sent,_(null!==n&&void 0!==n?n:[]);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}y&&function(){e.apply(this,arguments)}()}),[y]),(0,p.Z)((0,p.Z)({},H),{},{data:S,clear:K,pushNews:B})}(S,R.phoneNumber,E),A=M.data,H=M.isLoading,U=M.pushNews;return(0,y.jsxs)("div",{className:(0,u.Z)("h-full flex items-center flex-col",!t&&"p-2 md:p-5"),children:[!t&&(0,y.jsxs)("div",{className:"flex gap-2 mb-3",children:[(0,y.jsx)("input",{ref:_,defaultValue:R.phoneNumber,placeholder:"0911xxxxxx",className:"input",type:"text",maxLength:12}),(0,y.jsxs)("button",{className:"btn",type:"button",onClick:function(){if(_.current){var e=_.current.value;e&&e.match(/^[0-9]*$/)?T({phoneNumber:e.trim()}):i.Am.warn("".concat(L("invalid_phone_number")))}},children:[(0,y.jsx)(a.RB5,{}),L("search")]})]}),!H&&!(null!==A&&void 0!==A&&A.length)&&(0,y.jsx)(l.x4,{title:"Kh\xf4ng c\xf3 th\xf4ng tin"}),(0,y.jsxs)("div",{className:"max-w-[1000px] w-full flex-1 overflow-y-auto",ref:S,children:[(0,y.jsx)(k,{data:A,user:E,pushNews:U}),H&&(0,y.jsx)(l.x4,{title:(0,y.jsxs)("div",{className:"flex items-center gap-2",children:[(0,y.jsx)(a.Z7b,{className:"animate-spin"})," ",L("searching")]})})]})]})}},652:function(e,n,t){t.r(n),t.d(n,{default:function(){return h}});var r=t(9439),u=t(7313),s=t(5884),c=t(8468),a=t(3974),i=t(4511),l=t(8821),o=t(9466),f=t(1110),d=t(6417);function p(e){var n=e.user,t=e.profile,r=(0,i.$)().t;return n&&t?(0,d.jsxs)("div",{className:"p-5 w-full xl:w-72 h-fit flex-shrink-0 bg-white border rounded",children:[(0,d.jsxs)("div",{className:"flex justify-between items-end",children:[(0,d.jsx)(f.qE,{className:"!w-20 !h-20 ring ring-white"}),(0,d.jsxs)("div",{className:"flex items-center gap-2 px-2 bg-gray-50 rounded border",children:[(0,d.jsx)(l.jVv,{className:"text-green-500"}),(0,d.jsx)("span",{className:"font-bold",children:t.coins.toLocaleString("vi-VN",{currency:"VND"})}),(0,d.jsx)(o.rU,{to:"/ho-so/nap-tien",className:"bg-green-500 hover:bg-green-400 text-white rounded",children:(0,d.jsx)(l.L3d,{})})]})]}),(0,d.jsxs)("div",{className:"mt-5",children:[(0,d.jsx)("h1",{className:"font-bold truncate",children:n.displayName||n.phoneNumber}),(0,d.jsx)("ul",{className:"space-y-2 mt-2",children:(0,d.jsxs)("li",{children:[(0,d.jsxs)("span",{className:"text-gray-500",children:[r("join_at"),": "]})," ",new Date(n.metadata.creationTime).toLocaleDateString("vi-VN")]})})]})]}):null}function h(){var e=(0,s.P)(!0),n=e.user,t=e.profile,i=(0,c.K)(),l=(0,r.Z)(i,2),o=l[0],f=l[1];return(0,u.useEffect)((function(){n&&f({phoneNumber:"0"+n.phoneNumber.slice(3)})}),[n]),n?(0,d.jsxs)("div",{className:"max-w-[1024px] px-2 xl:px-0 py-5 mx-auto flex flex-col xl:flex-row gap-2 h-full",children:[(0,d.jsx)(p,{user:n,profile:t}),(0,d.jsx)("div",{className:"flex-grow",children:o&&(0,d.jsx)(a.default,{readOnly:!0,user:n})})]}):null}}}]);